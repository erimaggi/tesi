<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension-point id="com.treeage.treeagepro.ui.preferences" name="Tree Preferences" schema="schema/com.treeage.treeagepro.ui.preferences.exsd"/>
   <extension-point id="com.treeage.treeagepro.ui.util.treereports" name="Tree element reports" schema="schema/com.treeage.treeagepro.ui.util.treereports.exsd"/>
   <extension-point id="com.treeage.treeagepro.ui.prop.toolbar" name="Properties toolbar extension" schema="schema/com.treeage.treeagepro.ui.prop.toolbar.exsd"/>
    <extension id="product" point="org.eclipse.core.runtime.products">
        <product application="com.treeage.treeagepro.ui.runner"
            name="TreeAge Pro 2015">
            <property
                  name="windowImages"
                  value="icons/alt_window_16.gif,icons/alt_window_32.gif,icons/alt_window_48.gif,icons/alt_window_128.gif" />
            <property
                  name="appName"
                  value="TreeAge Pro 2015" />
            <property 
                  name="preferenceCustomization" 
                  value="plugin_customization.ini" />
            <property
                  name="aboutText"
                  value="%product.about">
            </property>
            <property
                  name="aboutImage"
                  value="icons/alt_about.bmp">
            </property>
            <property
                  name="startupProgressRect"
                  value="2,262,496,15">
            </property>
            <property
                  name="startupForegroundColor"
                  value="000000">
            </property>
            <property
                  name="startupMessageRect"
                  value="0,0,0,0">
            </property>
        </product>
    </extension>

    <extension id="runner"
        point="org.eclipse.core.runtime.applications">
        <application>
            <run class="com.treeage.treeagepro.app.Application"></run>
        </application>
    </extension>
    
    <extension point="org.eclipse.ui.presentationFactories">
        <factory class="com.treeage.treeagepro.app.DefaultPresentationFactory"
            id="com.treeage.treeagepro.app.DefaultPresentationFactory"
            name="%defaultFactory.name"/>
    </extension>

    <extension point="org.eclipse.ui.perspectives">
          <perspective name="Build"
            class="com.treeage.treeagepro.ui.perspectives.ModelBuildingPerspective"
            icon="icons/perspective/tree_building.png"
            id="com.treeage.treeagepro.ui.modelBuildingPerspective">
        </perspective>
        <perspective name="Analyze"
            class="com.treeage.treeagepro.ui.perspectives.ModelAnalysisPerspective"
            icon="icons/perspective/analysis_debugging.png"
            id="com.treeage.treeagepro.ui.modelAnalysisPerspective">
        </perspective>
        <perspective name="%perspectiveSimple.name"
            class="com.treeage.treeagepro.ui.perspectives.SimplePerspective"
            icon="icons/perspective/simple.png"
            id="com.treeage.treeagepro.ui.simplePerspective">
        </perspective>
        <perspective name="%perspectiveAdvanced.name"
            class="com.treeage.treeagepro.ui.perspectives.AdvancedPerspective"
            icon="icons/perspective/advanced.gif"
            id="com.treeage.treeagepro.ui.advancedPerspective">
        </perspective>       
        <perspective name="%perspectiveTreeBuilding.name"
            class="com.treeage.treeagepro.ui.perspectives.TreeBuildingPerspective"
            icon="icons/perspective/tree_building.png"
            id="com.treeage.treeagepro.ui.treeBuildingPerspective">
        </perspective>
        <perspective name="%perspectiveMarkovModeling.name"
            class="com.treeage.treeagepro.ui.perspectives.MarkovModelingPerspective"
            icon="icons/perspective/markov_modeling.png"
            id="com.treeage.treeagepro.ui.markovModelingPerspective">
        </perspective>
        <perspective name="%perspectiveSimulationModeling.name"
              class="com.treeage.treeagepro.ui.perspectives.SimulationModelingPerspective"
              icon="icons/perspective/simulation_modeling.png"
              id="com.treeage.treeagepro.ui.simulationModelingPerspective">
        </perspective>
         <perspective name="%perspectiveDiagramBuilding.name"
            class="com.treeage.treeagepro.ui.perspectives.DiagramBuildingPerspective"
            icon="icons/perspective/tree_building.png"
            id="com.treeage.treeagepro.ui.diagramBuildingPerspective">
        </perspective>
        <perspective name="%perspectiveAnalysis.name"
            class="com.treeage.treeagepro.ui.perspectives.AnalysisPerspective"
            icon="icons/perspective/analysis_debugging.png"
            id="com.treeage.treeagepro.ui.analysisPerspective">
        </perspective>
        <perspective name="%perspectiveDebugging.name"
              class="com.treeage.treeagepro.ui.perspectives.DebuggingPerspective"
              icon="icons/perspective/debugging.png"
              id="com.treeage.treeagepro.ui.debuggingPerspective">
        </perspective>
        <perspective
              class="com.treeage.treeagepro.ui.perspectives.PlayerModelPerspective"
              icon="icons/perspective/player.png"
              id="com.treeage.treeagepro.ui.playerModelPerspective"
              name="Player">
        </perspective>
    </extension>
    
    <extension
        point="org.eclipse.ui.services">
       <sourceProvider
             provider="com.treeage.treeagepro.ui.perspectives.TreeAgePerspectiveSourceProvider">
          <variable
                name="com.treeage.treeagepro.ui.currentPerspective"
                priorityLevel="workbench">
          </variable>
       </sourceProvider>
       <sourceProvider  provider="com.treeage.treeagepro.ui.service.NavigationSourceProvider">
          <variable name="com.treeage.treeagepro.ui.navigationList" priorityLevel="workbench">
          </variable>
       </sourceProvider>
    </extension>

    <extension
          point="com.treeage.treeagepro.oi.treeprovider">
       <treeProvider
             class="com.treeage.treeagepro.ui.util.UITreeProvider">
       </treeProvider>
    </extension>

    <extension point="org.eclipse.ui.commands">
        <category
            name="Help"
            id="com.treeage.treeagepro.ui.category.help" />
            
        <command
            name="%command.label.createErrorLogFile"
            categoryId="com.treeage.treeagepro.ui.category.help"
            id="com.treeage.treeagepro.help.sendUsageData">
           <defaultHandler class="com.treeage.treeagepro.ui.commands.CreateErrorLogFileHandler"/>
        </command>
        
        <command
            name="%command.label.update"
            categoryId="com.treeage.treeagepro.ui.category.help"
            id="com.treeage.treeagepro.app.command.update">
           <defaultHandler class="com.treeage.treeagepro.app.p2.UpdateHandler"/>
        </command>
        
        <command
            name="%command.label.install"
            categoryId="com.treeage.treeagepro.ui.category.help"
            id="com.treeage.treeagepro.app.command.install">
           <defaultHandler class="com.treeage.treeagepro.app.p2.InstallHandler"/>
        </command>
        
        <command 
            name="%command.label.importTreeAgeTreesFolder"
            id="com.treeage.treeagepro.ui.file.importTrees"
            categoryId="com.treeage.treeagepro.ui.category.other">
           <defaultHandler class="com.treeage.treeagepro.ui.commands.ConvertTreesToTrexHandler"/>
        </command>
        
        <command
              categoryId="com.treeage.treeagepro.ui.category.window"
              id="org.eclipse.ui.window.showTreeOnly"
              name="%command.label.showTreeOnly"
              defaultHandler="com.treeage.treeagepro.ui.commands.ShowTreeOnlyHandler">
        </command>
         
        <!-- Dev tools commands -->
        <command 
            name="%command.label.convertTREtoTREX"
            id="com.treeage.treeagepro.dev.ConvertAllTreToTrexHandler"
            categoryId="com.treeage.treeagepro.ui.category.other">
           <defaultHandler class="com.treeage.treeagepro.app.dev.ConvertAllTreToTrexHandler"/>
        </command>
         
    </extension>
       
    <!-- TODO Phase 6 Pestunov use org.eclipse.ui.actionSets extension point -->

    <extension point="org.eclipse.ui.menus">
<!-- 
        <menuContribution locationURI="menu:org.eclipse.ui.main.menu">
    For mac compatibility, creating most menus in ApplicationActionBarAdvisor.
    This appears to allow CocoaUIEnhancer to find About and ApplicationPreferences
    for Mac-style main menu item: "TreeAge Pro 2014". Also allows us to not duplicate
    those menuItems if we so choose.

            <menu id="treeagepro.app.file" label="%menu.label.file"/>

            <menu id="treeagepro.app.edit" label="%menu.label.edit"/>

            <separator name="additionsGroup"/>
            <menu
                  id="treeagepro.app.node"
                  label="%menu.label.node">
            </menu>
            <menu id="subtree" label="%menu.label.subtree"/>
            <menu
                  id="treeagepro.app.tree"
                  label="%menu.label.tree">
            </menu>

            <menu
                  id="treeagepro.app.analysis"
                  label="%menu.label.analysis">
            </menu>

            <separator name="optionsGroup"/>

            <menu id="treeagepro.app.window" label="%menu.label.window"/>
            <menu id="treeagepro.app.help" label="%menu.label.help"/>
        </menuContribution>
-->

        <menuContribution locationURI="menu:treeagepro.app.file">

            <separator name="fileGroup"/>
            <command
                  commandId="com.treeage.treeagepro.ui.command.createDiagram"
                  disabledIcon="icons/dtool16/create.gif"
                  icon="icons/etool16/create.gif"
                  label="%command.label.new"/>
            <command
                  commandId="com.treeage.treeagepro.ui.command.newTreeFromTemplate"
                  label="%command.label.newTreeFromTemplate"/>
                  
            <separator name="fileNewGroup" visible="false" />
            <command
                  commandId="com.treeage.treeagepro.ui.command.openDiagram"
                  disabledIcon="icons/dtool16/open.gif"
                  icon="icons/etool16/open.gif"
                  label="%command.label.open"/>
            <menu
                  id="reopenMenu"
                  label="%command.label.recentlyOpenedFiles"/>
            <command
                  commandId="org.eclipse.ui.file.close"
                  label="%command.label.close"/>
            <separator name="saveGroup" visible="true"/>

<!--                  commandId="org.eclipse.ui.file.save" -->
            <command
                  commandId="com.treeage.treeagepro.ui.command.save"
                  disabledIcon="icons/dtool16/save.gif"
                  icon="icons/etool16/save.gif"
                  label="%command.label.saveIt">
            </command>
            <command
                  commandId="org.eclipse.ui.file.saveAs"
                  disabledIcon="icons/dtool16/save_as.gif"
                  icon="icons/etool16/save_as.gif"
                  label="%command.label.saveAs">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
             <command
                   commandId="com.treeage.treeagepro.ui.command.saveInWorkspace"
                   disabledIcon="icons/dtool16/save_as.gif"
                   icon="icons/etool16/save_as.gif"
                   label="%command.label.saveInWorkspace">
                <visibleWhen>
                   <reference
                         definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                   </reference>
                </visibleWhen>
             </command>
            <separator
                  name="saveGroupAppend"
                  visible="true">
            </separator>

            <menu
                  id="com.treeagepro.app.saveAsImage"
                  label="%command.label.saveAsImage">
               <command
                     commandId="com.treeage.treeagepro.ui.file.saveAsSelectedImage"
                     label="%command.label.saveAsSelectedImage">
               </command>
               <command
                     commandId="com.treeage.treeagepro.ui.file.saveAsSubtreeImage"
                     label="%command.label.saveAsSubtreeImage">
               </command>
               <command
                     commandId="com.treeage.treeagepro.ui.file.saveAsEntireImage"
                     label="%command.label.saveAsEntireImage">
               </command>
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                  </reference>
               </visibleWhen>
             </menu>
             <separator name="saveImageGroupEnd" visible="false"/>
            <menu
                  id="com.treeagepro.app.importExportGroup"
                  label="%command.label.importExportWizard">
                <command commandId="org.eclipse.ui.file.import"/>
                <command commandId="org.eclipse.ui.file.export"/>

               <separator name="importExportAdditions" visible="true"/>
               <command
                     commandId="com.treeage.treeagepro.ui.file.import"
                     label="%command.label.importTreeAgeTableFiles">
                  <parameter
                        name="importWizardId"
                        value="com.treeage.treeagepro.ui.wizards.ImportTablesWizard">
                  </parameter>
               </command>               
               <command
                     commandId="com.treeage.treeagepro.ui.file.importTrees"
                     label="%command.label.importTreeAgeTreesFolder">
               </command>               

               <separator name="importExportAdditionsAppend" visible="false"/>
                <separator name="importExportGroupAppend" visible="false"/>
                <command
                      commandId="com.treeage.treeagepro.ui.command.saveAsEncrypted"
                      label="%command.label.exportAsEncrypted">
                </command>
                <command
                      commandId="com.treeage.treeagepro.ui.command.saveAsPlayerModel"
                      label="%command.label.exportAsPlayerModel">
                </command>
                <visibleWhen>
                   <reference
                         definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                   </reference>
                </visibleWhen>
               <!--command
                     commandId="com.treeage.treeagepro.ui.command.saveAsFileSystem"
                     label="%command.label.saveAsFileSystem">
               </command>
               <command
                     commandId="com.treeage.treeagepro.ui.command.saveAsTemplate"
                     label="%command.label.saveAsTemplate">
               </command>
               <command
                     commandId="com.treeage.treeagepro.ui.saveAsPackage"
                     label="%command.label.saveAsPackage">
               </command-->               
            </menu>
            <separator name="projectManagementGroup" visible="false"/>
            <menu
                  id="com.treeagepro.app.projectManagement"
                  label="%command.label.projects">
                <command
                      commandId="com.treeage.treeagepro.ui.file.switchWorkspace"
                      label="%command.label.switchWorkspace"
                      style="push">
                </command>
                <separator name="workspaceGroup" visible="true"/>
                <command commandId="com.treeage.treeagepro.ui.file.createProject" 
                    label="%command.label.createProject"/>
                <command commandId="com.treeage.treeagepro.ui.file.openProject" 
                    label="%command.label.openProject"/>
                <command commandId="com.treeage.treeagepro.ui.file.closeProject"
                    label="%command.label.closeProject"/>
                <separator name="projectManagementGroupAppend" visible="false"/>
            </menu>
            <separator name="projectManagementGroupEnd" visible="false"/>
            <separator
                  name="restartGroup"
                  visible="true">
            </separator>
            <command
                  commandId="com.treeage.treeagepro.ui.RestartAsAdmin"
                  label="%command.tooltip.restartAsAdmin"
                  style="push">
               <visibleWhen>
                  <test
                        property="com.treeage.treeagepro.ui.OSTEST">
                  </test>
               </visibleWhen>
            </command>
            <separator name="printGroup" visible="true"/>
            <command
                  commandId="org.eclipse.ui.file.print"
                  disabledIcon="icons/dtool16/print.gif"
                  icon="icons/etool16/print.gif"
                  label="%command.label.print">
            </command>
            <command
                  commandId="com.treeage.treeagepro.ui.file.printPreview"
                  label="%command.label.printPreview">
            </command>
            <separator name="additionsGroup"/>
            <separator
                  name="exitGroup"
                  visible="true">
            </separator>
<!-- Or only for non-Mac, so add in ActionBarAdvisor
            <command
                  commandId="com.treeage.treeagepro.ui.window.applicationPreferences"
                  disabledIcon="icons/none.gif"
                  icon="icons/none.gif"
                  label="%command.label.applicationPreferences">
            </command>
    -->            
        </menuContribution>
        <menuContribution locationURI="menu:treeagepro.app.edit">
            <separator name="historyGroup"/>
            <command
                  commandId="org.eclipse.ui.edit.undo"
                  disabledIcon="icons/dtool16/undo.gif"
                  icon="icons/etool16/undo.gif">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.edit.redo"
                  disabledIcon="icons/dtool16/redo.gif"
                  icon="icons/etool16/redo.gif">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <separator name="clipboardGroup" visible="true"/>
            <command
                  commandId="org.eclipse.ui.edit.cut"
                  disabledIcon="icons/dtool16/cut.gif"
                  icon="icons/etool16/cut.gif">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.edit.copy"
                  disabledIcon="icons/dtool16/copy.gif"
                  icon="icons/etool16/copy.gif">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.edit.paste"
                  disabledIcon="icons/dtool16/paste.gif"
                  icon="icons/etool16/paste.gif">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
          <menu
                id="treeClipboardsMenu"
                label="%edit.menu.label.treeClipboardsMenu">
              <command commandId="com.treeage.treeagepro.ui.diagram.command.treeClipboard1"
                      style="toggle"
                />
              <command commandId="com.treeage.treeagepro.ui.diagram.command.treeClipboard2"
                      style="toggle"
                />
              <command commandId="com.treeage.treeagepro.ui.diagram.command.treeClipboard3"
                      style="toggle"
                />
              <command commandId="com.treeage.treeagepro.ui.diagram.command.treeClipboard4"
                      style="toggle"
                />
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                 </reference>
              </visibleWhen>
          </menu>
        
            <separator
                  name="additionsGroup"
                  visible="true"/>
        </menuContribution>
        
        <!-- Subtree menu BEGINS --> 
        
        <menuContribution
              locationURI="menu:treeagepro.app.node">
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.addBranch"
                 icon="icons/etool16/new/add_branch.png">
                 <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
           </command>
           <menu
                 icon="icons/etool16/new/insert_node.png"
                 id="insertNodeMenu"
                 label="%command.label.insertNode">
                 <command 
                    commandId="com.treeage.treeagepro.ui.diagram.command.insertNode">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                 </command>                    
                 <separator name="startGroup" visible="true"/>
           </menu>
           <menu
                 icon="icons/etool16/change_type.png"
                 id="changeTypeMenu"
                 label="%command.label.changeType">
                 <command 
                    label="%command.label.changeNodeType"
                    commandId="com.treeage.treeagepro.ui.diagram.command.changeType">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                 </command>                    
                 <separator name="startGroup" visible="true"/>
           </menu>
           <menu id="changeProbFlexMenu"  label="Probability coherence"> 
                 <command  label="Change coherence to default" commandId="com.treeage.treeagepro.ui.diagram.command.changeFlexToDefault">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                 </command>
                 <command  label="Change coherence to allow" commandId="com.treeage.treeagepro.ui.diagram.command.changeFlexToAllow">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                 </command>
                 <command  label="Change coherence to not allow" commandId="com.treeage.treeagepro.ui.diagram.command.changeFlexToNotAllow">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                 </command>
                 <command  label="Change coherence to normalize" commandId="com.treeage.treeagepro.ui.diagram.command.changeFlexToNormalize">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                 </command>                                                                                          
                 <separator name="startGroup" visible="true"/>
           </menu>
           <command
                 commandId="org.eclipse.ui.edit.delete"
                 disabledIcon="icons/dtool16/delete.gif"
                 icon="icons/etool16/delete.gif"
                 label="%command.label.deleteIt">
                 <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
           </command>
           <separator
                 name="valuesGroup"
                 visible="true">
           </separator>
          <command
                commandId="org.eclipse.ui.views.showView"
                icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/node_properties.png"
                label="%command.label.showNodeProperties">
                <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
             <parameter
                   name="org.eclipse.ui.views.showView.viewId"
                   value="com.treeage.treeagepro.ui.views.NodeProperties">
             </parameter>
          </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.editPayoffs">
                 <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
           </command>
           <separator name="valuesGroup" visible="true"/>
           <menu id="defineVariableMenu" label="%command.label.defineVariable">
              <visibleWhen>
                 <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
           		<!-- Assume at root (assuming a root) [http://blog.eclipse-tips.com/2009/01/commands-part-2-selection-and.html] -->
           		<!--
                 <with variable="selection">
                    <count value="1"/>
                    <iterate>
                       <instanceof value="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"/>
                    </iterate>
                 </with>
				 -->
              </visibleWhen>
           </menu>
           <menu id="defineTrackerMenu" label="%command.label.defineTracker">
              <visibleWhen>
                 <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
              </visibleWhen>
           </menu>
           <menu
                 label="%menu.label.showNodeViews">
              <command
                    commandId="org.eclipse.ui.views.showView"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/variable_definitions.png"
                    label="%command.label.showVariableDefinitions">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
                 <parameter
                       name="org.eclipse.ui.views.showView.viewId"
                       value="com.treeage.treeagepro.ui.views.VariableDefinitions">
                 </parameter>
              </command>
              <command
                    commandId="org.eclipse.ui.views.showView"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/tracker_modifications.png"
                    label="%command.label.showTrackerModifications">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
                 <parameter
                       name="org.eclipse.ui.views.showView.viewId"
                       value="com.treeage.treeagepro.ui.views.TrackerModifications">
                 </parameter>
              </command>
              <separator name="valuesListMarkovGroup" visible="true"/>
              <command
                    commandId="org.eclipse.ui.views.showView"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/markov_info.png"
                    label="%command.label.showMarkovInfo">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
                 <parameter
                       name="org.eclipse.ui.views.showView.viewId"
                       value="com.treeage.treeagepro.ui.views.MarkovInfo">
                 </parameter>
              </command>
              <command
                    commandId="org.eclipse.ui.views.showView"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/des_info.png"
                    label="%command.label.showDESInfo">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
                 <parameter
                       name="org.eclipse.ui.views.showView.viewId"
                       value="com.treeage.treeagepro.ui.views.DESInfo">
                 </parameter>
              </command>
              <command
                    commandId="org.eclipse.ui.views.showView"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/markov_binds.png"
                    label="%command.label.showMarkBinds">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
                 <parameter
                       name="org.eclipse.ui.views.showView.viewId"
                       value="com.treeage.treeagepro.ui.views.MarkovBinds">
                 </parameter>
              </command>
              <separator name="valuesListMarkovGroupEnd" visible="true"/>
           </menu>
           <separator
                 name="additionsGroup"
                 visible="false">
           </separator>
           <separator
                 name="viewsGroup"
                 visible="true">
           </separator>
           <menu label="%menu.label.treePreferences">
                <command commandId="com.treeage.treeagepro.ui.diagram.editVarsMarkovDisplayPreferences">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
                    
                </command>
           </menu>
        </menuContribution>

        <menuContribution locationURI="menu:reopenMenu">
            <dynamic id="com.treeage.treeagepro.app.reopenMenu"
             class="com.treeage.treeagepro.ui.editors.diagram.actions.ReopenContributionItem"/>
        </menuContribution>
                
        <menuContribution locationURI="menu:defineVariableMenu">
             <dynamic id="com.treeage.treeagepro.app.dynamicDefineVariableMenu" 
               class="com.treeage.treeagepro.ui.editors.diagram.actions.define.DefineVariableContributionItem"/>
             <!--
             <separator name="tree" visible="true"/>
             <command
                   commandId="com.treeage.treeagepro.ui.filteredDefineDialog"
                   id="selectVariableToDefine"
                   label="Select..."
                   style="push"
                   tooltip="Select variable to define.">
             </command>
             -->
        </menuContribution>        
        
        <menuContribution locationURI="menu:defineTrackerMenu">
             <dynamic id="com.treeage.treeagepro.app.dynamicDefineTrackerMenu" 
               class="com.treeage.treeagepro.ui.editors.diagram.actions.define.DefineTrackerContributionItem"/>
             <separator name="tree" visible="true"/>
        </menuContribution>        
        
        <menuContribution locationURI="menu:insertNodeMenu">
            <command commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeLeft">
                     <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
             </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeRight">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeAbove">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeBelow">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
        </menuContribution>
        
        <menuContribution locationURI="menu:changeTypeMenu">
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToChanceNode"
                  icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_ChanceNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToTerminalNode"
                  icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_TerminalNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToDecisionNode"
                  icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DecisionNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToLogicNode"
                  icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_LogicNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToMarkovNode"
                  icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_MarkovNode.png">
                     <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToLabelNode"
                 icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_LabelNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToSummationNode"
                 icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_SummationNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToDESNode"
                 icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DESNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToTimeNode"
                 icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_TimeNode.png">
                    <visibleWhen>
                        <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                    </visibleWhen>
            </command>
        </menuContribution>
        
        
        <menuContribution locationURI="menu:nodeFontMenu">
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openNodeLabelFontDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openNodeLabelFontColorDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openProbabilityFontDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openProbabilityFontColorDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openEVFontDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openEVFontColorDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openVarFontDialog"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.openVarFontColorDialog"/>
        </menuContribution>
        <menuContribution
              locationURI="menu:treeagepro.app.subtree">
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.selectSubtree">
                         <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.deleteSubtree"
                 disabledIcon="icons/dtool16/delete.gif"
                 icon="icons/etool16/delete.gif"
                 label="%command.label.deleteIt">
                 <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                 </visibleWhen>
           </command>
           <separator
                 name="additionsGroup"
                 visible="false">
           </separator>
           <separator
                 name="externalSubtree"
                 visible="true">
           </separator>
       <!-- Disabled until tested/complete
           <menu
                 id="externalSubtreeMenu"
                 label="%command.label.externalSubtree">
           </menu>
        -->
           <separator
                 name="format"
                 visible="true">
           </separator>
           <menu id="nodeFontMenu" label="%command.label.format">
              <visibleWhen>
                 <and>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked"/>
                    <with variable="selection">
                       <count value="+"/>
                       <iterate>
                          <instanceof value="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"/>
                       </iterate>
                    </with>
                 </and>
              </visibleWhen>
           </menu>
        </menuContribution>
        <menuContribution
              locationURI="menu:externalSubtreeMenu">
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.detachSubtree">
                         <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.addSubtree">
                        <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.attachSubtree">
                         <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.loadSubtree">
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.unloadSubtree">
                        <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
           </command>
        </menuContribution>
        
        <!-- Options menu ENDS -->
        
        <menuContribution locationURI="menu:treeagepro.app.tree" >
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.selectRoot">
                 <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
           </command>
            <separator name="searchGroup" visible="false"/>
                  <command commandId="org.eclipse.search.ui.openSearchDialog" label="%command.label.find">
                        <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
                  </command>                         
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.selectNodes">
                        <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
                 </command>
            <separator name="valuesGroup" visible="true"/>
            <!--
            <menu label="New Value">
            </menu>
            -->
            <command commandId="org.eclipse.ui.views.showView"
                label="%command.label.showTreeProperties"
                icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/tree_properties.png">
                        <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                        </visibleWhen>
                <parameter
                      name="org.eclipse.ui.views.showView.viewId"
                      value="com.treeage.treeagepro.ui.views.TreeProperties" />
            </command>
           <!--command
                 commandId="org.eclipse.ui.views.showView"
                 icon="platform:/plugin/org.eclipse.ui.views/icons/full/eview16/outline_co.gif"
                 label="%command.label.showOutline">
              <parameter
                    name="org.eclipse.ui.views.showView.viewId"
                    value="com.treeage.treeagepro.ui.ContentOutline">
              </parameter>
           </command-->
            <separator name="viewsGroup" visible="true"/>
            <menu label="%menu.label.showTreeValuesView">
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showVariableProperties"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/variables_properties.png">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                     </visibleWhen>
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.VariableProperties" />
                </command>
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showTrackerProperties"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/trackers_properties.png">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                     </visibleWhen>
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.TrackerProperties" />
                </command>
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showDistributionProperties"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/distributions_properties.png">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                     </visibleWhen>
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.DistributionProperties" />
                </command>
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showTableProperties"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/tables_properties.png">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                     </visibleWhen>
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.TableProperties" />
                </command>
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showCloneProperties"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/clones_properties.png">
                    <visibleWhen>
                            <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                     </visibleWhen>
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.CloneProperties" />
                </command>
            </menu>
           <separator
                 name="treePreferencesGroup" visible="true">
           </separator>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
                 label="%menu.label.treePreferences">
                 <visibleWhen>
                     <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.command.outcomesWizard"
                 icon="icons/etool16/new/configure_model.png"
                 label="Configure Model">
                 <visibleWhen>
                     <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.configureModelPreference" label="Auto-Configure New Models" style="toggle">                 
                 <visibleWhen>
                     <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
           </command>
           <separator
                 name="endPreferencesGroup">
           </separator>
        
        </menuContribution>
        <menuContribution
              locationURI="menu:treeagepro.app.values">
           <separator
                 name="variablesGroup">
           </separator>
           <command
                 commandId="com.treeage.treeagepro.ui.values.ShowView"
                 icon="icons/full/view16/variables_properties.png"
                 label="%command.label.variablePropertiesView"
                 style="push">
              <parameter
                    name="viewID"
                    value="com.treeage.treeagepro.ui.views.VariableProperties">
              </parameter>
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.values.ShowView"
                 icon="icons/full/view16/variable_definitions.png"
                 label="%command.label.variableDefinitionsView"
                 style="push">
              <parameter
                    name="viewID"
                    value="com.treeage.treeagepro.ui.views.VariableDefinitions">
              </parameter>
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <separator
                 name="tablesGroup"
                 visible="true">
           </separator>
           <command
                 commandId="com.treeage.treeagepro.ui.values.ShowView"
                 icon="icons/full/view16/tables_properties.png"
                 label="%command.label.tablesView"
                 style="push">
              <parameter
                    name="viewID"
                    value="com.treeage.treeagepro.ui.views.TableProperties">
              </parameter>
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <separator
                 name="distributionsGroup"
                 visible="true">
           </separator>
           <command
                 commandId="com.treeage.treeagepro.ui.values.ShowView"
                 icon="icons/full/view16/distributions_properties.png"
                 label="%command.label.distributionsView"
                 style="push">
              <parameter
                    name="viewID"
                    value="com.treeage.treeagepro.ui.views.DistributionProperties">
              </parameter>
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <separator
                 name="trackersGroup"
                 visible="true">
           </separator>
           <command
                 commandId="com.treeage.treeagepro.ui.values.ShowView"
                 icon="icons/full/view16/trackers_properties.png"
                 label="%command.label.trackersPropertiesView"
                 style="push">
              <parameter
                    name="viewID"
                    value="com.treeage.treeagepro.ui.views.TrackerProperties">
              </parameter>
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.values.ShowView"
                 icon="icons/full/view16/tracker_modifications.png"
                 label="%command.label.trackersModificationsView"
                 style="push">
              <parameter
                    name="viewID"
                    value="com.treeage.treeagepro.ui.views.TrackerModifications">
              </parameter>
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
        </menuContribution>

        <menuContribution
              locationURI="menu:treeagepro.app.analysis">
           <separator 
                 name="additionsGroup" visible="false">
           </separator>
        </menuContribution>
         
        <menuContribution locationURI="menu:window?after=startGroup">
        
            <separator name="newEditorGroup"/>
            <command
                  commandId="org.eclipse.ui.window.showTreeOnly"
                  icon="/icons/full/editor16/tree_document_obj.png"
                  label="%command.label.showTreeOnly"
                  style="toggle">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.window.newEditor"
                  label="%command.label.newEditor">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <!--command commandId="org.eclipse.ui.window.newWindow" 
                label="%command.label.newWindow" /-->

            <separator name="viewsGroup" visible="true"/>
            <menu label="%menu.label.showView" id="com.treeage.treeagepro.ui.menu.window.showView"/>

            <separator name="perspectiveGroup" visible="true"/>
            <command
                  commandId="org.eclipse.ui.perspectives.showPerspective"> 
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.customizePerspective"
                  label="%command.label.customizePerspective">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.window.savePerspective"
                  label="%command.label.savePerspective">
               <visibleWhen>
                  <not>
                     <reference
                           definitionId="treeagepro.ui.isPlayerPerspectiveOpen">
                     </reference>
                  </not>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.window.closePerspective"
                  label="%command.label.closePerspective">
               <visibleWhen>
                  <reference
                        definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.ui.window.resetPerspective"
                  label="%command.label.resetPerspective">
            </command>
<!--
            trying: org.eclipse.ui.window.preferences
            
            <separator name="prefsGroup" visible="true"/>
            <command commandId="com.treeage.treeagepro.ui.window.applicationPreferences"
                label="%command.label.applicationPreferences" />
-->
        </menuContribution>
        
        <menuContribution locationURI="menu:help?after=additions">
        
            <command id="welcome" commandId="com.treeage.treeagepro.help.sendUsageData"
                label="%command.label.createErrorLogFile" />

            <separator name="welcomeGroup" visible="true"/>
            
            <command id="welcome"
                commandId="org.eclipse.ui.help.quickStartAction"
                label="%command.label.welcome" />
                
            <separator name="helpGroup" visible="true"/>

            <command id="dynamicHelp"
               commandId="org.eclipse.ui.help.dynamicHelp"
               label="%command.label.help"/>
               
            <command id="helpContents"
               commandId="org.eclipse.ui.help.helpContents"
               label="%command.label.helpBrowser"/>
               
            <separator name="additionsGroup"  visible="true"/>
            
            <command id="update" commandId="com.treeage.treeagepro.app.command.update"/>
            <command id="install" commandId="com.treeage.treeagepro.app.command.install"/>
            
            <separator name="aboutGroup" visible="false"/>
        </menuContribution>
        
        <menuContribution locationURI="toolbar:org.eclipse.ui.main.toolbar"> 
            <!-- Back/forward buttons -->
            <toolbar id="treeagepro.navigate.toolbar.pulldown" > </toolbar>
            <toolbar id="treeagepro.app.toolbar" label="%toolbar.label.main">
                <separator name="fileGroup" visible="true"/>        
            </toolbar>
            
            <toolbar
                  id="treeagepro.node.toolbar"
                  label="%toolbar.label.node">
               <separator
                     name="startGroup"
                     visible="false"/>               
             </toolbar>
            
            <toolbar
                  id="treeagepro.views.toolbar"
                  label="%toolbar.label.views">
               <separator
                     name="startGroup"
                     visible="false">
               </separator>          
            </toolbar>
            
            <toolbar
                  id="treeagepro.analysis.toolbar"
                  label="%toolbar.label.analysis">                
            </toolbar>
            
            <!--toolbar id="treeagepro.navigate.toolbar.pulldown" > </toolbar-->
            <toolbar
                  id="treeagepro.app.toolbar"
                  label="%toolbar.label.main">
                <separator name="fileGroup" visible="true"/>           
            <!--Simple-->
                          
  <command commandId="com.treeage.treeagepro.ui.command.createDiagram" label="New Tree">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
            </command>    
  
                
            <separator name="com.treeage.treeagepro.ui.diagram.addBranchSeparator" visible="true" >  
            </separator>
                <!-- Add Branch -->
                <command commandId="com.treeage.treeagepro.ui.diagram.command.addBranch" 
                    label="%toolbar.label.addBranch">  
                      <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
                </command>
                
            <separator name="com.treeage.treeagepro.ui.diagram.insertNodeSeparator" visible="true" >  
            </separator>
                <!--- Insert Node -->
                <command commandId="com.treeage.treeagepro.ui.diagram.command.insertNode"
                    label="%toolbar.label.insertNode">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>            
                </command>
                
                          
            <separator name="com.treeage.treeagepro.ui.diagram.command.deleteNodeSimpleSeparator" visible="true" >  
            </separator>
  
          <command commandId="com.treeage.treeagepro.ui.diagram.command.deleteNodeSimple" label="Delete Node" >
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
            </command>    
                
            <separator name="com.treeage.treeagepro.ui.diagram.changeTypeSeparator" visible="true" >  
            </separator>

                <command commandId="com.treeage.treeagepro.ui.diagram.command.changeType"
                    label="%toolbar.label.changeType">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
                </command>
                
             <separator name="com.treeage.treeagepro.ui.diagram.command.editLabelSeparator" visible="true"> 
            </separator> 

                <command commandId="com.treeage.treeagepro.ui.diagram.command.editLabel"  label="%toolbar.label.editLabel">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
            </command>            
            
            <separator name="com.treeage.treeagepro.ui.diagram.command.editProbabilitySeparator" visible="true"> 
            </separator>             
            <!-- Enter Probability -->            
            <command commandId="com.treeage.treeagepro.ui.diagram.command.editProbability" 
                      label="%toolbar.label.editProbability">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
            </command>
            
            <separator name="com.treeage.treeagepro.ui.diagram.command.undoSeparator" visible="true"> 
            </separator>             
            
            <command commandId="com.treeage.treeagepro.ui.diagram.command.undoSimple"
                      label = "Undo">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
            </command>
            
           <separator name="com.treeage.treeagepro.ui.diagram.rollBackSeparator" visible="true"> 
            </separator>
                <command commandId="com.treeage.treeagepro.ui.diagram.rollBack"
                    label="%toolbar.label.rollBack" style="toggle" tooltip="%command.label.rollBack">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
                </command>
                
            <separator name="com.treeage.treeagepro.ui.diagram.editTreePreferencesSeparator" visible="true"> 
            </separator>
           
                <command commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
                    label="%toolbar.label.treePrefs">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                           </and>
                     </visibleWhen>
                </command>
            <!--Simple-->
            </toolbar> 
            
            <toolbar id="treeagepro.modelbuild.toolbar.fileactions" label="Document features and file actions">
            <!-- New Decision Tree -->
               <command commandId="com.treeage.treeagepro.ui.command.createDiagram" tooltip="New Decision Tree" 
                    icon="icons/etool16/create.gif" 
                    disabledIcon="icons/dtool16/create.gif">
                   <visibleWhen  checkEnabled="false">
                         <not>
                            <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                         </not>
                     </visibleWhen> 
                </command>                  
               <!-- Open File -->
                <command commandId="com.treeage.treeagepro.ui.command.openDiagram"  tooltip="Open an existing TreeAge Pro Document "
                    icon="icons/etool16/open.gif" 
                    disabledIcon="icons/dtool16/open.gif">
                   <visibleWhen  checkEnabled="false">
                         <not>
                            <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                         </not>
                     </visibleWhen>
                </command>                
                <!--Save/Save As-->
                <!--
                     commandId="org.eclipse.ui.file.save" 
                 -->
                <command
                    commandId="com.treeage.treeagepro.ui.command.save" tooltip="Save Document"
                    icon="icons/etool16/save.gif" 
                    disabledIcon="icons/dtool16/save.gif">
                   <visibleWhen  checkEnabled="false">
                                     <not>
                                        <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                                     </not>
                     </visibleWhen>
                </command>        
            </toolbar>
            <toolbar id="treeagepro.modelbuild.toolbar.configuration" label="Model configuration">
                 <!--Tree Preferences-->         
                <command commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
                      disabledIcon="icons/dtool16/tree_preferences.png"
                      icon="icons/etool16/tree_preferences.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <not>
                                    <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                              </not>
                           </and>
                     </visibleWhen>
                </command>                
                <!-- Configure Model -->
                <command commandId="com.treeage.treeagepro.ui.command.outcomesWizard" tooltip="Configure Model"
                      disabledIcon="icons/dtool16/configure_model.png"
                      icon="icons/etool16/new/configure_model.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <not>
                                    <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                              </not>
                           </and>
                     </visibleWhen>
                </command>                      
                <!--  Open/Activate Diagram Properties View -->
                <command commandId="org.eclipse.ui.views.showView"
                    label="Diagram Properties View" tooltip="Open Diagram Properties View"
                    icon="platform:/plugin/com.treeage.treeagepro.diagram.editor/icons/full/view16/properties.png">
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.diagram.editor.view.DiagramProperties" />
                     <visibleWhen checkEnabled="false">
                            <and>
                                <not>
                                    <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                                </not>
                            <or>
                              <reference definitionId="treeagepro.ui.isActiveStateDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActiveInfluenceDiagramEditor"/>
                            </or>
                            </and>                            
                    </visibleWhen>
                </command>          
            </toolbar>
            
            <!--Model analysis / Decision tree context-->
            <toolbar id="treeagepro.modelanalysis.toolbar.treecontext" label="Model analysis">
                <!--Rollback-->
                <command
                      commandId="com.treeage.treeagepro.ui.diagram.rollBack"
                      disabledIcon="icons/dtool16/rollback.png"
                      icon="icons/etool16/rollback.png"
                      label="%command.label.rollBack"
                      style="toggle">
                      <visibleWhen
                         checkEnabled="false">
                            <and>
                               <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                               <reference definitionId="treeagepro.ui.isActivePerspectiveModelAnalysis"/>
                            </and>
                      </visibleWhen>
                </command>                 
            </toolbar>
              
              <toolbar id="treeagepro.modelbuild.toolbar.build" label="Model building/editing ">
              <!-- Undo -->
              <command commandId="com.treeage.treeagepro.ui.diagram.command.undoSimple" label = "Undo"
              icon="IMG_TOOL_UNDO" disabledIcon="IMG_TOOL_UNDO_DISABLED">               
                   <visibleWhen checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
            </command>
            <!-- Add branch -->
            <command commandId="com.treeage.treeagepro.ui.diagram.command.addBranch" 
                    label="%toolbar.label.addBranch" icon="icons/etool16/new/add_branch.png">  
                      <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
                </command>
            <!-- Insert node -->    
                   <command commandId="com.treeage.treeagepro.ui.diagram.command.insertNode"
                    label="%toolbar.label.insertNode" icon="icons/etool16/new/insert_node.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>            
                </command>
              <!-- Change Node Type-->     
                <command
                      commandId="com.treeage.treeagepro.ui.diagram.command.changeType"
                      disabledIcon="icons/dtool16/change_type.png"
                      icon="icons/etool16/change_type.png"
                      label="%command.label.changeNodeType"
                      tooltip="%command.tooltip.changeNodeType">
                   <visibleWhen 
                        checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
                </command>                
             <!-- Enter Probability -->            
            <command commandId="com.treeage.treeagepro.ui.diagram.command.editProbability" 
                      label="%toolbar.label.editProbability"
                      icon="icons/etool16/new/enter_probability.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
            </command>
            <!-- Complement Probability -->
            <command commandId="com.treeage.treeagepro.ui.diagram.command.editComplementProbability" 
                      label="Complement probability"  tooltip="Set probability to complement"
                      icon="icons/etool16/new/set_probability_to_complement.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
            </command>
            <!-- Children's Probability-->
            <command commandId="com.treeage.treeagepro.ui.diagram.command.editChildrenProbability" 
                      label="Complement probability"  tooltip="Set probability to complement"
                      icon="icons/etool16/new/enter_all_probs.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
            </command>
            </toolbar>
            
                          <toolbar id="treeagepro.modelbuild.toolbar.inputs" label="Model inputs">
                 <!-- Add Variable -->
                 <command commandId="com.treeage.treeagepro.ui.diagram.command.defineNewVariable" label = "Add Variable" tooltip="Add Variable"
                 icon="icons/etool16/new/add_variable.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
                </command>
                <!-- Add Table -->
                <command commandId="com.treeage.treeagepro.ui.diagram.command.newTable" label = "Add Table"
                icon="icons/etool16/new/add_table.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
                </command>                
                 <!-- Add Distribution -->
                <command commandId="com.treeage.treeagepro.ui.diagram.command.newDistribution" label = "Add Distribution"
                icon="icons/etool16/new/add_distribution.png">
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                           </and>
                     </visibleWhen>
                </command>     
                 <!-- Variable Properties -->
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showVariableProperties" tooltip="Open Variable Properties View"
                    icon="icons/etool16/variables_properties.png"
                    disabledIcon="icons/dtool16/variable_properties.png">
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.VariableProperties" />
                     <visibleWhen checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>                              
                           </and>
                    </visibleWhen>
                </command>                
                <!-- Variable Definitions -->
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showVariableDefinitions"
                    icon="icons/etool16/variable_definitions.png" tooltip="Open Variable Definitions View"
                    disabledIcon="icons/dtool16/variable_definitions.png">
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.VariableDefinitions" />
                     <visibleWhen checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>                              
                           </and>
                    </visibleWhen>
                </command>
                <!-- Distributions -->
                 <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showDistributionProperties" tooltip="Open Distributions View"
                    icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/distributions_properties.png">
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.DistributionProperties" />
                     <visibleWhen checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>                              
                           </and>
                    </visibleWhen>
                </command>
                 <!-- Markov Info -->
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showMarkovInfo"
                    icon="icons/etool16/markov_info.png" tooltip="Open Markov Info View"
                    disabledIcon="icons/dtool16/markov_info.png">
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.MarkovInfo" />
                     <visibleWhen checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>                              
                           </and>
                    </visibleWhen>
                </command>                
                <!-- DES Info -->
                <command commandId="org.eclipse.ui.views.showView"
                    label="%command.label.showDESInfo" tooltip="Open DES Info View"
                    icon="icons/etool16/des_info.png"
                    disabledIcon="icons/dtool16/des_info.png">
                    <parameter
                          name="org.eclipse.ui.views.showView.viewId"
                          value="com.treeage.treeagepro.ui.views.DESInfo" />
                   <visibleWhen  checkEnabled="false">
                           <and>
                              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                              <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>                              
                           </and>
                     </visibleWhen>
                </command>
              </toolbar>
            
            <toolbar id="treeagepro.modelbuild.toolbar.other" label="Other">
            <!-- Rollback/Calculate  -->
                <command
                      commandId="com.treeage.treeagepro.ui.diagram.rollBack"
                      disabledIcon="icons/dtool16/rollback.png"
                      icon="icons/etool16/rollback.png"
                      label="%command.label.rollBack" tooltip="Roll Back/Calculate Model"
                      style="toggle">
                      <visibleWhen
                         checkEnabled="false">
                            <and>
                               <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                               <reference definitionId="treeagepro.ui.isActivePerspectiveNotSimple"/>
                            </and>
                      </visibleWhen>
                </command>                
                <!-- Find in tree -->
                  <command commandId="org.eclipse.search.ui.openSearchDialog" label="%command.label.find" tooltip="Find in Tree"
                  icon="IMG_ETOOL_HELP_SEARCH">
                    <visibleWhen>
                            <and>
                                <not><reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/> </not>
                                <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                            </and>
                     </visibleWhen>
                  </command>                
                <!-- Help -->  
                  <command
                    id="dynamicHelp"
                    commandId="org.eclipse.ui.help.dynamicHelp"
                    icon="IMG_LCL_LINKTO_HELP"
                    label="%command.label.help">
                    <visibleWhen>
                        <and>
                            <not>
                                <reference definitionId="treeagepro.ui.isActivePerspectiveSimple"/>
                            </not>
                             <or>
                                <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                                <reference definitionId="treeagepro.ui.isActiveStateDiagramEditor"/>
                                <reference definitionId="treeagepro.ui.isActiveInfluenceDiagramEditor"/>
                                <reference definitionId="treeagepro.ui.isActiveReportEditor"/>
                            </or>
                        </and>
                      </visibleWhen>
                    </command>
                </toolbar>
             <!--Views -->
            <toolbar id="treeagepro.views.toolbar.pulldown" label="Views">
            </toolbar>
        </menuContribution>

        <menuContribution locationURI="menu:treeagepro.app.devtools">
            <command commandId="com.treeage.treeagepro.dev.ConvertAllTreToTrexHandler" label="Convert TRE to TREX"/>
        </menuContribution>
                
    </extension>
    

    <extension point="org.eclipse.ui.bindings">
       <scheme
             id="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
             name="%defaultAcceleratorScheme.name">
       </scheme>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.editPayoffs"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+Y"/>
        <key 
            commandId="com.treeage.treeagepro.ui.perspectives.viewsPullDownAction"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M3+Q" />    
        <key 
            commandId="com.treeage.treeagepro.ui.command.createDiagram"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+N" />
        <key 
            commandId="com.treeage.treeagepro.ui.command.openDiagram"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+O" />
        <key 
            platform="win32"
            commandId="org.eclipse.ui.file.close"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="CTRL+F4" />
        <key 
            commandId="org.eclipse.ui.file.close"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+W" />
        <!--
            commandId="org.eclipse.ui.file.save"
        -->
        <key 
            commandId="com.treeage.treeagepro.ui.command.save"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+S" />
        <key 
            commandId="org.eclipse.ui.file.saveAs"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+S" />
        <key 
            commandId="com.treeage.treeagepro.ui.command.saveInWorkspace"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M3+S" />
        <key 
            commandId="org.eclipse.ui.file.print"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+P" />
        <key 
            commandId="com.treeage.treeagepro.ui.file.printPreview"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+P" />
        <key 
            commandId="org.eclipse.ui.file.exit"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M3+F4" />
        <key 
            commandId="org.eclipse.ui.edit.undo"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+Z" />
        <key 
            commandId="org.eclipse.ui.edit.redo"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+Z" />
        <key 
            commandId="org.eclipse.ui.edit.cut"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+X" />
        <key 
            commandId="org.eclipse.ui.edit.copy"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+C" />
        <key 
            commandId="org.eclipse.ui.edit.paste"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+V" />
        <key 
            commandId="org.eclipse.ui.window.nextPerspective"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+F8" />    
        <key
            commandId="org.eclipse.ui.window.nextEditor"
            sequence="M1+F6"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration" />
        <key
            commandId="org.eclipse.ui.window.nextView"
            sequence="M1+F7"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration" />    
        <!--
           - Commented due to Eclipse selects arbitrary keystroke for command 
           - when more than one keystroke are defined. 
           - TODO key binding workaround
        <key 
            commandId="org.eclipse.ui.edit.cut"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M2+DEL"/>
        <key 
            platform="carbon"
            commandId=""
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M2+DEL"/>
        <key 
            commandId="org.eclipse.ui.edit.copy"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+INSERT" />
        <key 
            platform="carbon"
            commandId=""
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+INSERT" />
        <key 
            commandId="org.eclipse.ui.edit.paste"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M2+INSERT" />
        <key 
            platform="carbon"
            commandId=""
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M2+INSERT" />
        -->
        <key 
            commandId="org.eclipse.ui.edit.delete"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+DEL" />
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.command.deleteSubtree"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+DEL" />
        <key 
            commandId="org.eclipse.search.ui.openSearchDialog"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+F" />
        <key
            commandId="org.eclipse.ui.edit.text.contentAssist.proposals"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            contextId="org.eclipse.ui.contexts.dialogAndWindow"
            sequence="CTRL+SPACE"/> <!-- Command+SPACE+* is reserved on carbon, hardcode to CTRL -->
        <!-- Help in browser -->
        <key
            commandId="org.eclipse.ui.help.helpContents"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+F1"/>

        <!-- Help View -->
        <key
            commandId="org.eclipse.ui.help.dynamicHelp"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="F1"/>

        <key
            commandId="org.eclipse.ui.edit.text.contentAssist.proposals"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="CTRL+SPACE"/>
            
         <!-- Command+SPACE+* is reserved on carbon, hardcode to CTRL -->
            <!--
              commandId="com.treeage.treeagepro.ui.window.applicationPreferences"
        <key
              commandId="org.eclipse.ui.window.preferences"
              schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
              sequence="M1+,"/>
              -->
    </extension>

    <extension point="org.eclipse.ui.startup">
        <startup class="com.treeage.treeagepro.ui.StartupActivator"/>
    </extension>
    
   <extension
       point = "org.eclipse.ui.viewActions">
         <viewContribution 
            id="com.treeage.treeagepro.ui.views.OpenErrorReportDialogContribution" 
            targetID="org.eclipse.pde.runtime.LogView">        
	     <action id="com.treeage.treeagepro.ui.actions.OpenErrorReportDialogAction" 
                 label="E-mail" 
	             tooltip="%command.tooltip.sendErrorReport"
	             toolbarPath="errorReportGroup" 
   	             class="com.treeage.treeagepro.ui.editors.diagram.actions.OpenErrorReportDialogAction"
   	             enablesFor="+" 
                 >
	      </action>
         </viewContribution>
    </extension>

	<extension point="org.eclipse.ui.importWizards">
		<category
            name="TreeAge Pro 200X Data"
            id="com.treeage.treeagepro.200X">
      	</category>

        <wizard
            id="com.treeage.treeagepro.ui.wizards.ImportTablesWizard"
            name="%tablesImport"
            class="com.treeage.treeagepro.ui.wizards.ImportTablesWizard"
            icon="icons/full/assist16/table.png"
            category="com.treeage.treeagepro.200X">

            <description>Import TreeAge Pro 200X Tables (*.TBL)</description>
        </wizard>
   	</extension>

    <extension point="org.eclipse.ui.commands">            
        <category
            name="File"
            id="com.treeage.treeagepro.ui.category.file" />
        <category
            name="Edit"
            id="com.treeage.treeagepro.ui.category.edit" />
        <category
            name="Options"
            id="com.treeage.treeagepro.ui.category.options" />
        <category
            name="Window"
            id="com.treeage.treeagepro.ui.category.window" />
        <category
            name="Search"
            id="com.treeage.treeagepro.ui.category.search" />
        <category
            name="Analysis"
            id="com.treeage.treeagepro.ui.category.analysis" />
        <category
            name="Diagram"
            id="com.treeage.treeagepro.ui.category.diagram" />
        <category
            name="Navigate"
            id="com.treeage.treeagepro.ui.category.navigate" />
        <category
            name="Other"
            id="com.treeage.treeagepro.ui.category.other" />
        <command                
                description="Export"
                id="com.treeage.treeagepro.ui.file.export"
                categoryId="com.treeage.treeagepro.ui.category.file"
                name="Export">
                <commandParameter
                    id="exportWizardId"
                    name="exportWizardId"
                    optional="true"
                    values="org.eclipse.ui.internal.registry.WizardParameterValues$Export"/>
        </command>
        <command                
                description="Import"
                id="com.treeage.treeagepro.ui.file.import"
                categoryId="com.treeage.treeagepro.ui.category.file"
                name="Import">
                <commandParameter
                    id="importWizardId"
                    name="importWizardId"
                    optional="true"
                    values="org.eclipse.ui.internal.registry.WizardParameterValues$Export"/>
        </command>
        <command id="com.treeage.treeagepro.ui.command.createDiagram"
            categoryId="com.treeage.treeagepro.ui.category.file"
            defaultHandler="com.treeage.treeagepro.ui.commands.CreateDiagramHandler"
            name="New" 
            description="New Decision Tree" />
        <command id="com.treeage.treeagepro.ui.command.newTreeFromTemplate"
            categoryId="com.treeage.treeagepro.ui.category.file"
            defaultHandler="com.treeage.treeagepro.ui.commands.NewTreeFromTemplateHandler"
            name="New Tree From Template"/>

            <command id="com.treeage.treeagepro.ui.command.outcomesWizard"
            categoryId="com.treeage.treeagepro.ui.category.options"
            defaultHandler="com.treeage.treeagepro.ui.commands.CalculationWizardHandler"
            name="Configure Model " 
            description="Configure Model">
            </command>
        <command id="com.treeage.treeagepro.ui.command.save"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Save" 
            description="Save Document" />
        <command id="com.treeage.treeagepro.ui.command.saveAsEncrypted"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="%command.label.ExportAsEncrypted" 
            description="Saves an open diagram as encrypted model" />
        <command
              categoryId="com.treeage.treeagepro.ui.category.file"
              description="Saves an open diagram as player model"
              id="com.treeage.treeagepro.ui.command.saveAsPlayerModel"
              name="%command.label.saveAsPlayerModel">
        </command>
        <command id="com.treeage.treeagepro.ui.command.saveInWorkspace"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="%command.label.saveInWorkspace" 
            description="Save Document" />
        <!--command id="com.treeage.treeagepro.ui.command.saveAsFileSystem"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Save As... (File System)" 
            description="Saves an open diagram or report to a specified location" /-->
        <!--command id="com.treeage.treeagepro.ui.command.saveAsTemplate"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Save As Template..." 
            description="Saves an open tree diagram as a template" /-->
        <command id="com.treeage.treeagepro.ui.command.openDiagram"
            categoryId="com.treeage.treeagepro.ui.category.file"
            defaultHandler="com.treeage.treeagepro.ui.commands.OpenDiagramHandler"
            name="Open..." 
            description="Open an existing TreeAge Pro Document" />
        <command id="com.treeage.treeagepro.ui.command.importOldTblFiles"
            categoryId="com.treeage.treeagepro.ui.category.file"
            defaultHandler="com.treeage.treeagepro.ui.commands.ConvertAllTblToTrexHandler"
            name="Import Table Files"
            description="Imports existing global *.tbl table files" />
        <command id="com.treeage.treeagepro.ui.saveAsPackage"
            categoryId="com.treeage.treeagepro.ui.category.file"
            defaultHandler="com.treeage.treeagepro.ui.commands.SaveAsPackageHandler"
            name="Create Package"
            description="Save Document" />
        <command id="com.treeage.treeagepro.ui.file.saveAsSelectedImage"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Save Image of Selected Nodes"
            description="Saves parts of a diagram as an image" />
        <command id="com.treeage.treeagepro.ui.file.saveAsSubtreeImage"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Save Image of Selected Subtree"
            description="Saves subtree as an image" />
        <command id="com.treeage.treeagepro.ui.file.saveAsEntireImage"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Save Image of All Nodes"
            description="Saves a tree diagram as an image" />

        <command id="com.treeage.treeagepro.ui.file.switchWorkspace"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Switch Workspace" 
            description="Switch to an existing or new workspace" />
            
        <command id="com.treeage.treeagepro.ui.file.createProject"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="%command.label.createProject"
            description="Creates a new project" />    
        <command id="com.treeage.treeagepro.ui.file.openProject"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="%command.label.openProject"
            description="Opens an existing project" />
        <command id="com.treeage.treeagepro.ui.file.closeProject"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="%command.label.closeProject"
            description="Closes an opened project" />
	    <command id="com.treeage.treeagepro.ui.file.printPreview"
            categoryId="com.treeage.treeagepro.ui.category.file"
            name="Print Preview" 
	        description="Opens print preview" />
     <command
           categoryId="com.treeage.treeagepro.ui.category.edit"
           id="com.treeage.treeagepro.ui.diagram.enterDesignerPassword"
           name="%command.label.enterDesignerPassword">
        <defaultHandler
              class="com.treeage.treeagepro.ui.util.GMFActionHandler">
           <parameter
                 name="actionClass"
                 value="com.treeage.treeagepro.ui.editors.diagram.actions.EnterDesignPasswordAction">
           </parameter>
        </defaultHandler>
     </command>
<!--
            id="org.eclipse.ui.window.preferences"

        <command
             id="com.treeage.treeagepro.ui.window.applicationPreferences"
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Application Preferences..." 
            description="Edits the application preferences" />    
            
 -->
        <!-- "Options" menu commands BEGIN -->
        <command id="com.treeage.treeagepro.ui.diagram.command.addBranch" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Add Branch">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.AddBranchAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.excludeStrategy" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Exclude Strategy">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ExcludeStrategyAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeType" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Node Type">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ShowChangeNodeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.defineNewVariable"
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="New variable">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                    value="com.treeage.treeagepro.ui.editors.diagram.actions.NewVariableAction"/>
             </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.newDistribution"
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="New distribution">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                    value="com.treeage.treeagepro.ui.editors.diagram.actions.NewDistributionAction"/>
             </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.newTable"
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="New Table">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                    value="com.treeage.treeagepro.ui.editors.diagram.actions.NewTableAction"/>
             </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.evaluateAction"
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Evaluate Node Action">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                    value="com.treeage.treeagepro.ui.editors.diagram.actions.EvaluateAction"/>
             </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.nodeComments" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Show Node Comments">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ShowNodeCommentsAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.subtreeBayesRevisionWizard" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%command.label.bayesRevisionWizard">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ShowBayesRevisionWizardAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.subtreeBayesRevision" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%command.label.bayesRevision">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ShowBayesRevisionDialogAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.insertNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%subtree.menu.label.insertNode">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ShowInsertNodeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.treeClipboard1" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%edit.menu.label.treeClipboard1">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.TreeClipboardAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.treeClipboard2" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%edit.menu.label.treeClipboard2">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.TreeClipboardAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.treeClipboard3" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%edit.menu.label.treeClipboard3">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.TreeClipboardAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.treeClipboard4" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="%edit.menu.label.treeClipboard4">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.TreeClipboardAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.insertNodeLeft" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Insert Node Left">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.InsertNodeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.insertNodeRight" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Insert Node Right">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.InsertNodeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.insertNodeAbove" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Insert Node Above">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.InsertNodeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.insertNodeBelow" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Insert Node Below">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.InsertNodeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToChanceNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type to Chance Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToTerminalNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type to Terminal Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToDecisionNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type to Decision Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToLogicNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type to Logic Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToMarkovNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type to Markov Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToLabelNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type To Label Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToSummationNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type To Summation Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToDESNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type To DES Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>

        <command id="com.treeage.treeagepro.ui.diagram.command.changeTypeToTimeNode" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Type To Time Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeTypeAction"/>
            </defaultHandler>
        </command>
        
         <command id="com.treeage.treeagepro.ui.diagram.command.changeFlexToDefault" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Coherence to Default">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeFlexAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeFlexToAllow" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Coherence to Allow">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeFlexAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeFlexToNotAllow" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Coherence to Not Allow">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeFlexAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.changeFlexToNormalize" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Change Coherence to normalize">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFParameterizedActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeFlexAction"/>
            </defaultHandler>
        </command>
      
        <command id="com.treeage.treeagepro.ui.diagram.command.convertToSTD" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Convert To STD"
            description="Converts current Markov sub-tree into State Transition Diagram">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ConvertToSTDAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.selectNodes" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Select Nodes If">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.SelectNodesAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.selectRoot" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Select Root">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.SelectRootAction"/>
            </defaultHandler>
        </command>       
        
        <command id="com.treeage.treeagepro.ui.diagram.command.selectSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Select Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.SelectSubtreeAction"/>
            </defaultHandler>
        </command>       
        
        <command id="com.treeage.treeagepro.ui.diagram.command.deleteSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Delete Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DeleteSubtreeAction"/>
            </defaultHandler>
        </command>       
        
        <command id="com.treeage.treeagepro.ui.diagram.command.editPayoffs" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Edit Payoffs">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ShowPayoffsDialogAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.detachSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Detach Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DetachSubtreeAction"/>
            </defaultHandler>
        </command>       
        
        <command id="com.treeage.treeagepro.ui.diagram.command.addSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Add Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.AddSubtreeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.attachSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="_attachSubtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.AttachSubtreeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.loadSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="_loadSubtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.LoadSubtreeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.unloadSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="_unloadSubtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.UnloadSubtreeAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.openProbabilityFontDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="_openProbabilityFontDialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.ProbabilityFontDialogAction"/>
            </defaultHandler>
        </command>       

        <command id="com.treeage.treeagepro.ui.diagram.command.openNodeLabelFontDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Open Node Label Font Dialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.NodeLabelFontDialogAction"/>
            </defaultHandler>
        </command>       

        <command id="com.treeage.treeagepro.ui.diagram.command.openEVFontDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Open EV Font Dialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.ExpectedValuesFontDialogAction"/>
            </defaultHandler>
        </command>       
       
        <command id="com.treeage.treeagepro.ui.diagram.command.openVarFontDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Open Variables Font Dialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.VariablesFontDialogAction"/>
            </defaultHandler>
        </command>       
       
        <command id="com.treeage.treeagepro.ui.diagram.command.openProbabilityFontColorDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="_openProbabilityFontColorDialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.ProbabilityFontColorDialogAction"/>
            </defaultHandler>
        </command>       

        <command id="com.treeage.treeagepro.ui.diagram.command.openNodeLabelFontColorDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Open Node Label Font Color Dialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.NodeLabelFontColorDialogAction"/>
            </defaultHandler>
        </command>       

        <command id="com.treeage.treeagepro.ui.diagram.command.openEVFontColorDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Open EV Font Color Dialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.ExpectedValuesFontColorDialogAction"/>
            </defaultHandler>
        </command>       
       
        <command id="com.treeage.treeagepro.ui.diagram.command.openVarFontColorDialog" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Open Variables Font Color Dialog">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.format.VariablesFontColorDialogAction"/>
            </defaultHandler>
        </command>       
       
       <!-- "Options" menu commands END -->
        
        <command id="com.treeage.treeagepro.ui.diagram.createOrDestroyCloneMaster" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Create Or Destroy Clone Master">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.CloneMasterManagerAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.attachOrDetachClone" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Attach Or Detach Clone">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.CloneManagerAction"/>
            </defaultHandler>
        </command>

        <command id="com.treeage.treeagepro.ui.diagram.expectedValue"
        categoryId="com.treeage.treeagepro.ui.category.analysis"
        name="Expected Value"> 
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DisplayExpectedValueAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.pathProbability"
        categoryId="com.treeage.treeagepro.ui.category.analysis"
        name="Path Probability">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DisplayPathProbabilityAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.payoffRange"
        categoryId="com.treeage.treeagepro.ui.category.analysis"
        name="Payoff Range"> 
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DisplayPayoffRangeAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.standardDeviation"
        categoryId="com.treeage.treeagepro.ui.category.analysis"
        name="Standard Deviation"> 
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DisplayStandardDeviationAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.editTreePreferences" 
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Edit Tree Preferences">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditTreePreferencesAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.configureModelPreference" 
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Configure model" description="Show Configure Model Wizard with creation of tree model">
            <state
                  id="com.treeage.treeagepro.ui.diagram.configureModelPreference.state">
                  <class class="org.eclipse.jface.commands.ToggleState">
                  </class>
            </state>            
        </command>        
        <command id="com.treeage.treeagepro.ui.diagram.editLinksPreferences" 
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Edit Spreadsheet Links Preferences">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditSpreadsheetLinksPreferencesAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.editTreeNumericFormatPreferences" 
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Edit Tree Numeric Format Preferences">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditTreeNumericFormatPreferencesAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.editVarsMarkovDisplayPreferences" 
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Edit Variables and Markov Display Preferences">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditTreeVarsMarkovDisplayPreferencesAction"/>
            </defaultHandler>
        </command>
 
        <command id="com.treeage.treeagepro.ui.diagram.editFontPreferences" 
            categoryId="com.treeage.treeagepro.ui.category.window"
            name="Edit Font Preferences">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditFontPreferencesAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.EVPI"
        categoryId="com.treeage.treeagepro.ui.category.analysis"
        name="EVPI">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DisplayEVPI"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.overUnderProbabilities"
        categoryId="com.treeage.treeagepro.ui.category.analysis"
        name="Over Under Probabilities">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.DisplayOverUnderProbabilities"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.skipGeneration" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Skip Generation">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.SkipGenerationAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.unskipGeneration" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Unskip Generation">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.UnskipGenerationAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.collapseSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Collapse Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.CollapseSubtreeAction"/>
            </defaultHandler>
        </command>
        <command
              categoryId="com.treeage.treeagepro.ui.category.diagram"
              description="Collapse subtree and aggressively recover memory resources"
              id="com.treeage.treeagepro.ui.diagram.hardCollapseSubtree"
              name="Hard Collapse Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.HardCollapseSubtreeAction"/>
            </defaultHandler>
        </command>
		<command id="com.treeage.treeagepro.ui.diagram.expandSubtreeOnce" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Expand Subtree Once">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ExpandSubtreeOnceAction"/>
            </defaultHandler>
        </command>		            
		<command id="com.treeage.treeagepro.ui.diagram.expandEntireSubtree" 
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Expand Entire Subtree">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ExpandEntireSubtreeAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.changeOptimalPath"
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Change Optimal Path">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                    value="com.treeage.treeagepro.ui.editors.diagram.actions.ChangeOptimalPathAction"/>
            </defaultHandler>
        </command>
        <command id="com.treeage.treeagepro.ui.diagram.rollBack"
            categoryId="com.treeage.treeagepro.ui.category.diagram"
            name="Roll Back">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                    value="com.treeage.treeagepro.ui.editors.diagram.actions.RollBackAction" />
            </defaultHandler>
        </command>
        
         <command id="com.treeage.treeagepro.ui.diagram.command.editLabel"
          categoryId="com.treeage.treeagepro.ui.category.options" 
            name="Edit Label">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditLabelAction"/>
            </defaultHandler>
        </command>

        <command id="com.treeage.treeagepro.ui.diagram.command.editProbability" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Edit Probability">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.EditProbabilityAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.editComplementProbability" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Complement Probability">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ComplementProbabilityAction"/>
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.editChildrenProbability" 
            categoryId="com.treeage.treeagepro.ui.category.options"
            name="Edit Children's Probability">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="com.treeage.treeagepro.ui.editors.diagram.actions.ChildrenProbabilityAction"/>
            </defaultHandler>
        </command>
        
          <command id="com.treeage.treeagepro.ui.diagram.command.deleteNodeSimple"
          categoryId="com.treeage.treeagepro.ui.category.options" 
            name="Delete Node">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="org.eclipse.gmf.runtime.common.ui.action.internal.actions.global.GlobalDeleteAction"/>
                     <parameter name="overrideLabelText" value="Delete Node"/>     
            </defaultHandler>
        </command>
        
        <command id="com.treeage.treeagepro.ui.diagram.command.undoSimple"
          categoryId="com.treeage.treeagepro.ui.category.options" 
            name="Undo" label="Undo">
            <defaultHandler class="com.treeage.treeagepro.ui.util.GMFActionHandler">
                <parameter name="actionClass"
                     value="org.eclipse.gmf.runtime.common.ui.action.actions.global.GlobalUndoAction"/>
                <parameter name="overrideLabelText" value="Undo"/>     
            </defaultHandler>
        </command>

            <!--command id="com.treeage.treeagepro.ui.diagram.command.evaluateAction"
                categoryId="com.treeage.treeagepro.ui.category.options"
                name="Evaluate Node Action">
            </command-->
        
        <!-- External Subtree commands -->
        <command id="treeagepro.ui.subtree.addBranch" 
            name="subtree.addBranch"
            categoryId="com.treeage.treeagepro.ui.category.diagram"/>

        <!-- Dynamic documentation commands -->
        <command
            name="%command.label.createDoc"
            categoryId="com.treeage.treeagepro.ui.category.file"
            id="com.treeage.treeagepro.ui.createDoc">
            <commandParameter id="template" name="template" optional="false"/>
            <commandParameter id="fileName" name="fileName" optional="false"/>
        </command>

        <command
            name="%command.label.saveDocAs"
            categoryId="com.treeage.treeagepro.ui.category.file"
            id="com.treeage.treeagepro.ui.saveDocAs"/>
        <command
            name="%command.label.openSpreadsheetDoc"
            categoryId="com.treeage.treeagepro.ui.category.file"
            id="com.treeage.treeagepro.ui.openSpreadsheetDoc"/>
            
        <!-- perspective commands -->
        <command id="com.treeage.treeagepro.ui.customizePerspective" 
            name="%command.label.customizePerspective"
            categoryId="com.treeage.treeagepro.ui.category.window"/>
        <command id="com.treeage.treeagepro.ui.perspectives.viewsPullDownAction"
            name="%command.label.viewList"
            categoryId="com.treeage.treeagepro.ui.category.window"/>
        <command
              categoryId="com.treeage.treeagepro.ui.category.window"
              id="com.treeage.treeagepro.ui.values.ShowView"
              name="ShowView">
           <commandParameter
                 id="viewID"
                 name="viewID"
                 optional="true"
                 typeId="string">
           </commandParameter>
           <defaultHandler
                 class="com.treeage.treeagepro.ui.commands.ShowViewHandler">
           </defaultHandler>
        </command>
        <command
              categoryId="com.treeage.treeagepro.ui.category.file"
              defaultHandler="com.treeage.treeagepro.ui.commands.RestartAsAdminHandler"
              id="com.treeage.treeagepro.ui.RestartAsAdmin"
              name="RestartAsAdmin">
        </command>
        <!--command id="org.eclipse.ui.navigate.back" name="Back" categoryId="com.treeage.treeagepro.ui.category.navigate"/-->
        <!--command id="org.eclipse.ui.navigate.forward" name="Forward" categoryId="com.treeage.treeagepro.ui.category.navigate"/-->
        <!--
        <command
              categoryId="com.treeage.treeagepro.ui.category.options"
              defaultHandler="com.treeage.treeagepro.ui.commands.ShowFilteredDefineVariableDialogHandler"
              id="com.treeage.treeagepro.ui.filteredDefineDialog"
              name="Select...">
        </command>
        -->
    </extension>
    
    <extension point="org.eclipse.core.expressions.definitions">
    
        <definition id="treeagepro.ui.isActiveTreeDiagramEditorSelected">            
           <with variable="activeEditor">
              <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
           </with>
        </definition>
        
        <definition id="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
           <!--not>
              <systemTest property="treeagepro.systemPropertyLockEditing" value="lock"/>
           </not-->
           <with variable="activeEditor">
              <test property="com.treeage.treeagepro.ui.isEditorUnlocked"/>
           </with>
        </definition>
        
        <definition id="treeagepro.ui.isActiveTreeDiagramEditor">
           <and>
              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditorSelected"/>
              <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked"/>
           </and>
        </definition>
        
         <definition id="treeagepro.ui.isActiveStateDiagramEditor">
           <with variable="activeEditor">
              <instanceof value="com.treeage.treeagepro.stdx.editor.StateDiagramEditor"/>
           </with>
        </definition>
        
        <definition id="treeagepro.ui.isActiveInfluenceDiagramEditor">
           <with variable="activeEditor">
              <instanceof value="com.treeage.treeagepro.diagram.editor.DiagramEditor"/>
           </with>
        </definition>

        <definition id="treeagepro.ui.isActivePerspectiveModelAnalysis">
                     <with variable="com.treeage.treeagepro.ui.currentPerspective">
                            <equals value="com.treeage.treeagepro.ui.modelAnalysisPerspective"/>
                     </with>
        </definition>
        
        <definition id="treeagepro.ui.isActivePerspectiveSimple">
                     <with variable="com.treeage.treeagepro.ui.currentPerspective">
                            <equals
                                    value="com.treeage.treeagepro.ui.simplePerspective">
                            </equals>
                     </with>
                     <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditorSelected"/>
        </definition>
        
        <definition id="treeagepro.ui.isActivePerspectiveNotSimple">
                <not>
                     <with variable="com.treeage.treeagepro.ui.currentPerspective">
                            <or>
                            <equals
                                    value="com.treeage.treeagepro.ui.simplePerspective">
                            </equals>
                            <equals
                                    value="com.treeage.treeagepro.ui.modelAnalysisPerspective">
                            </equals>
                            </or>
                     </with>
                </not>
                <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditorSelected"/>
        </definition>
        
        <definition id="treeagepro.ui.isActiveOldPerspective">
           <and>
                <not>
                    <with  variable="com.treeage.treeagepro.ui.currentPerspective">
                           <equals
                                  value="com.treeage.treeagepro.ui.simplePerspective">
                            </equals>
                     </with>
                 </not>
                 <not>
                    <with variable="com.treeage.treeagepro.ui.currentPerspective">
                            <equals
                                    value="com.treeage.treeagepro.ui.advancedPerspective">
                           </equals>
                   </with>
                </not>
           </and>
        </definition>
                
        <definition id="treeagepro.ui.isActiveEditor">
            <with variable="activeEditor">
                <instanceof value="org.eclipse.ui.IEditorPart"/>
            </with>
        </definition>
        <definition
              id="treeagepro.ui.isPlayerPerspectiveOpen">
           <with
                 variable="activeWorkbenchWindow.activePerspective">
              <equals
                    value="com.treeage.treeagepro.ui.playerModelPerspective">
              </equals>
           </with>
        </definition>
        
         <definition id="treeagepro.ui.isActiveReportEditor">
           <with variable="activeEditor">
              <instanceof value="com.treeage.treeagepro.ui.reports.ReportEditor"/>
           </with>
        </definition>
        
    </extension>
    
    <extension point="org.eclipse.ui.handlers">
        <handler commandId="com.treeage.treeagepro.ui.diagram.configureModelPreference">
        <class class="com.treeage.treeagepro.ui.editors.diagram.commands.ConfigureModelHandler">
        </class>        
        <activeWhen>
                <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
            </activeWhen>
        </handler>     
        <handler commandId="com.treeage.treeagepro.ui.file.export"
            class="org.eclipse.ui.internal.handlers.WizardHandler$Export">
            <activeWhen>
                    <with variable="activeEditor">
                        <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
                    </with>
            </activeWhen>
        </handler>    
        <handler commandId="com.treeage.treeagepro.ui.file.import"
            class="org.eclipse.ui.internal.handlers.WizardHandler$Import">
        </handler>    
        <handler commandId="com.treeage.treeagepro.ui.command.save"
            class="com.treeage.treeagepro.ui.commands.SaveHandler">
            <activeWhen>
                <reference definitionId="treeagepro.ui.isActiveEditor"/>
            </activeWhen>
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.command.saveAsEncrypted"
            class="com.treeage.treeagepro.ui.commands.SaveAsEncryptedHandler">
            <activeWhen>
                <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
            </activeWhen>
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.command.saveAsPlayerModel"
            class="com.treeage.treeagepro.ui.commands.SaveAsPlayerModelHandler">
            <activeWhen>
                <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
            </activeWhen>
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.command.saveInWorkspace"
            class="com.treeage.treeagepro.ui.commands.SaveInWorkspaceHandler">
            <activeWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>                    
            </activeWhen>
        </handler>          
        <!--handler commandId="com.treeage.treeagepro.ui.command.saveAsTemplate"
            class="com.treeage.treeagepro.ui.commands.SaveAsTemplateHandler">
            <activeWhen>
                	<with variable="activeEditor">
                        <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
                    </with>
            </activeWhen>
        </handler-->
        <handler commandId="com.treeage.treeagepro.ui.file.printPreview"
            class="com.treeage.treeagepro.ui.commands.OpenPrintPreviewHandler">
            <activeWhen>
                	<with variable="activeEditor">
                        <instanceof value="org.eclipse.gmf.runtime.diagram.ui.resources.editor.parts.DiagramDocumentEditor"/>
                    </with>
            </activeWhen>
        </handler>

        <handler commandId="com.treeage.treeagepro.ui.file.saveAsSelectedImage"
            class="com.treeage.treeagepro.ui.commands.SaveAsImageHandler">
            <activeWhen>
                	<with variable="activeEditor">
                        <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
                    </with>
            </activeWhen>
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.file.saveAsSubtreeImage"
            class="com.treeage.treeagepro.ui.commands.SaveAsSubtreeImageHandler">
            <activeWhen>
                    <with variable="activeEditor">
                        <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
                    </with>
            </activeWhen>
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.file.saveAsEntireImage"
            class="com.treeage.treeagepro.ui.commands.SaveAsEntireImageHandler">
            <activeWhen>
                    <with variable="activeEditor">
                        <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
                    </with>
            </activeWhen>
        </handler>

        <handler commandId="com.treeage.treeagepro.ui.file.switchWorkspace"
            class="com.treeage.treeagepro.ui.commands.SwitchWorkspaceHandler">
        </handler>
        
        <handler commandId="org.eclipse.ui.perspectives.showPerspective" 
            class="com.treeage.treeagepro.ui.commands.TreeageShowPerspectiveHandler" >
            <activeWhen>
                    <with variable="activeEditor">
                        <instanceof value="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"/>
                    </with>
            </activeWhen>
        </handler>
        <!--
        <handler commandId="com.treeage.treeagepro.ui.window.applicationPreferences"
            class="com.treeage.treeagepro.ui.commands.OpenApplicationPreferencesHandler">
        </handler>
        -->
        <handler commandId="com.treeage.treeagepro.ui.file.createProject"
            class="com.treeage.treeagepro.ui.commands.CreateProjectHandler">
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.file.closeProject"
            class="com.treeage.treeagepro.ui.commands.CloseProjectHandler">
        </handler>
        <handler commandId="com.treeage.treeagepro.ui.file.openProject"
            class="com.treeage.treeagepro.ui.commands.OpenProjectHandler">
        </handler>
        <handler commandId="org.eclipse.ui.file.print"
            class="com.treeage.treeagepro.ui.commands.PrintDiagramHandler">
            <activeWhen>
                <with variable="activeEditor">
                    <instanceof value="org.eclipse.gmf.runtime.diagram.ui.resources.editor.parts.DiagramDocumentEditor"/>
                </with>
            </activeWhen>
        </handler>
        
        <handler 
            commandId="com.treeage.treeagepro.ui.createDoc"
            class="com.treeage.treeagepro.ui.commands.CreateModelDocumentationHandler" />

        <handler 
            commandId="com.treeage.treeagepro.ui.saveDocAs"
            class="com.treeage.treeagepro.ui.commands.SaveModelDocumentationHandler" />

        <handler 
            commandId="com.treeage.treeagepro.ui.openSpreadsheetDoc"
            class="com.treeage.treeagepro.ui.commands.OpenModelDocumentationSpreadsheetHandler" />
        
        <handler
            commandId="com.treeage.treeagepro.ui.customizePerspective"
            class="com.treeage.treeagepro.ui.perspectives.CustomizePerspectiveHandler">
        </handler>
        
        <!--handler
              class="com.treeage.treeagepro.ui.commands.EnterDesignerPasswordHandler"
              commandId="com.treeage.treeagepro.ui.diagram.enterDesignerPassword">
        </handler-->
    </extension>
    
    <extension point="org.eclipse.ui.editors">
        <editor name="%treeDiagramEditorName" icon="/icons/full/editor16/tree_document_obj.png"
            class="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor"
            contributorClass="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditorActionBarContributor"
            matchingStrategy="org.eclipse.gmf.runtime.diagram.ui.resources.editor.parts.DiagramDocumentEditorMatchingStrategy"
            default="true"
            extensions="trex,trcx,trvx"
            id="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">
            <contentTypeBinding contentTypeId="com.treeage.tree"/>
            <contentTypeBinding contentTypeId="com.treeage.treeEncrypted"/>
            <contentTypeBinding contentTypeId="com.treeage.treePlayer"/>
            <contentTypeBinding contentTypeId="com.treeage.treeCompressed"/>
        </editor>
        <editor name="%treeTemplateDiagramEditorName" icon="/icons/full/editor16/tree_template_obj.png"
            launcher="com.treeage.treeagepro.ui.editors.diagram.TreeModelTemplateLauncher"
            default="true"
            id="com.treeage.treeagepro.ui.editors.diagram.TreeModelTemplateLauncher">
            <contentTypeBinding contentTypeId="com.treeage.treeTemplate"/>
        </editor>
        <editor name="%tp9DiagramEditorName" icon="/icons/full/editor16/tp9_obj.gif"
            launcher="com.treeage.treeagepro.ui.editors.diagram.OldTreeModelLauncher"
            default="true"
            id="com.treeage.treeagepro.ui.editors.diagram.OldTreeModelLauncher">
            <contentTypeBinding contentTypeId="com.treeage.200x.tree"/>
            <contentTypeBinding contentTypeId="com.treeage.200x.package"/>
            <contentTypeBinding contentTypeId="com.treeage.data40.tree"/>
            <contentTypeBinding contentTypeId="com.treeage.data35.tree"/>
            <contentTypeBinding contentTypeId="com.treeage.data30.tree"/>
        </editor>
        <editor name="%subtreeEditorName" icon="/icons/full/editor16/external_subtree_obj.png"
            class="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeEditor"
            contributorClass="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeDiagramEditorActionBarContributor"
            id="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeEditor"
            default="true">
            <contentTypeBinding contentTypeId="com.treeage.subtree"/>
        </editor>
        <editor name="%tablesEditorName" icon="/icons/full/editor16/global_tables_obj.png"
            class="com.treeage.treeagepro.ui.editors.tables.TablesEditor"
            contributorClass="com.treeage.treeagepro.ui.editors.tables.TablesEditorActionBarContributor"
            id="com.treeage.treeagepro.ui.editors.table.TablesEditor"
            default="true">
            <contentTypeBinding contentTypeId="com.treeage.tables"/>
        </editor>
        <editor name="%oldTablesEditorName" icon="/icons/full/editor16/global_tables_obj.png"
            launcher="com.treeage.treeagepro.ui.editors.tables.OldTablesEditorLauncher"
            id="com.treeage.treeagepro.ui.editors.tables.OldTablesEditorLauncher"
            default="true"
            extensions="tbl">
            <contentTypeBinding contentTypeId="com.treeage.200x.tables"/>
        </editor>
        <editor name="%treePackageEditorName" icon="/icons/full/editor16/tree_package_obj.png"
            id="com.treeage.treeagepro.ui.editors.multipage.TreePackageEditor"
            class="com.treeage.treeagepro.ui.editors.multipage.TreePackageEditor"
            default="true">
        </editor>
        <editor name="%treePackageEditorName" icon="/icons/full/editor16/tree_package_obj.png"
            id="com.treeage.treeagepro.ui.editors.multipage.TreePackageEditorLauncher"
            launcher="com.treeage.treeagepro.ui.editors.multipage.TreePackageEditorLauncher"
            default="true">
            <contentTypeBinding contentTypeId="com.treeage.package"/>
        </editor>
    </extension>

    <extension point="org.eclipse.ui.views">
        <view name="%view.name.treeExplorer" 
            class="com.treeage.treeagepro.ui.views.Explorer"
            icon="icons/full/view16/explorer.gif"
            id="com.treeage.treeagepro.ui.views.Explorer">
        </view>
        <view name="%view.name.treeProperties" 
            class="com.treeage.treeagepro.ui.views.PropertySheet"
            icon="icons/full/view16/tree_properties.png"
            id="com.treeage.treeagepro.ui.views.TreeProperties">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/clones_properties.png"
              id="com.treeage.treeagepro.ui.views.CloneProperties"
              name="%view.name.cloneMastersCopies">
        </view>
        <view name="%view.name.nodeProperties" 
            class="com.treeage.treeagepro.ui.views.PropertySheet"
            icon="icons/full/view16/node_properties.png"
            id="com.treeage.treeagepro.ui.views.NodeProperties">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/variables_properties.png"
              id="com.treeage.treeagepro.ui.views.VariableProperties"
              name="%view.name.variableProperties">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/variable_definitions.png"
              id="com.treeage.treeagepro.ui.views.VariableDefinitions"
              name="%view.name.variableDefinitions">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/tables_properties.png"
              id="com.treeage.treeagepro.ui.views.TableProperties"
              name="%view.name.tables">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/distributions_properties.png"
              id="com.treeage.treeagepro.ui.views.DistributionProperties"
              name="%view.name.discriptions">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/trackers_properties.png"
              id="com.treeage.treeagepro.ui.views.TrackerProperties"
              name="%view.name.trackerProperties">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/tracker_modifications.png"
              id="com.treeage.treeagepro.ui.views.TrackerModifications"
              name="%view.name.trackerModifications">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/markov_info.png"
              id="com.treeage.treeagepro.ui.views.MarkovInfo"
              name="%view.name.markovInfo">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/des_info.png"
              id="com.treeage.treeagepro.ui.views.DESInfo"
              name="%view.name.DESInfo">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/markov_binds.png"
              id="com.treeage.treeagepro.ui.views.MarkovBinds"
              name="%view.name.stateBindings">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.Evaluator"
              icon="icons/full/view16/evaluator.gif"
              id="com.treeage.treeagepro.ui.views.Evaluator"
              name="%view.name.evaluator">
        </view>
        <view name="%view.name.probabilityWheel" 
            class="com.treeage.treeagepro.ui.views.ProbabilityWheelView"
            icon="icons/full/view16/probability_wheel.png"
            id="com.treeage.treeagepro.ui.views.ProbabilityView">
        </view>
        <view name="%view.name.projects" 
            class="com.treeage.treeagepro.ui.views.ProjectNavigator"
            icon="icons/full/view16/project_navigator.png"
            id="com.treeage.treeagepro.ui.views.ProjectNavigator">
        </view>
        
        <!-- HIDE (in favor of XML)
        <view name="Node Outline" 
            class="com.treeage.treeagepro.ui.views.NodeOutline"
            icon="icons/full/view16/node_outline.png"
            id="com.treeage.treeagepro.ui.views.NodeOutline">
        </view>
         -->
        <view
              name="%view.name.modelOverview"
              class="org.eclipse.ui.views.contentoutline.ContentOutline"
              id="com.treeage.treeagepro.ui.ContentOutline"
              restorable="true">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/player_main.png"
              id="com.treeage.treeagepro.ui.views.PlayerAnalysis"
              name="%view.name.PlayerView">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.PropertySheet"
              icon="icons/full/view16/player_design.png"
              id="com.treeage.treeagepro.ui.views.PlayerDesign"
              name="%view.name.PlayerDesign">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.validation.ValidationLogView"
              icon="icons/full/view16/validation.gif"
              id="com.treeage.treeagepro.ui.views.ValidationLogView"
              name="%view.name.validationLog"
              restorable="true">
        </view>
        <view
              class="com.treeage.treeagepro.ui.views.dashboard.DashboardView"
              icon="icons/full/view16/dashboard.png"
              id="com.treeage.treeagepro.ui.views.Dashboard"
              name="Dashboard"
              restorable="true">
        </view>
    </extension>

   <extension point="org.eclipse.ui.navigator.viewer">
       <viewer
             helpContext="com.treeage.treeagepro.project_explorer_context"
             viewerId="com.treeage.treeagepro.ui.views.ProjectNavigator">
          <popupMenu
                allowsPlatformContributions="true"
                id="org.eclipse.ui.navigator.ProjectExplorer#PopupMenu">  
             <insertionPoint name="group.new"/>
             <insertionPoint
                   name="group.open"
                   separator="true"/>
             <insertionPoint name="group.openWith"/>   
             <insertionPoint name="group.edit"
                   separator="true"/>   
             <insertionPoint name="group.reorganize" />         
             <insertionPoint
                   name="group.port"
                   separator="true"/>     
             <insertionPoint
                   name="group.build"
                   separator="true"/> 
             <insertionPoint
                   name="group.generate"
                   separator="true"/> 
             <insertionPoint
                   name="group.search"
                   separator="true"/>              
             <insertionPoint
                   name="additions"
                   separator="true"/>              
             <insertionPoint
                   name="group.properties"
                   separator="true"/>
             
          </popupMenu>
          <options>
             <property
                   name="org.eclipse.ui.navigator.customizeViewDialogHelpContext"
                   value="org.eclipse.ui.project_explorer_customization_dialog">
             </property>
          </options>
       </viewer>
       <viewerContentBinding viewerId="com.treeage.treeagepro.ui.views.ProjectNavigator">
          <includes>
              <contentExtension pattern="org.eclipse.ui.navigator.resourceContent" />                     
              <contentExtension pattern="com.treeage.treeagepro.ui.*" />                     
              <contentExtension pattern="org.eclipse.ui.navigator.resources.filters.*"/>
              <contentExtension pattern="org.eclipse.ui.navigator.resources.linkHelper"/>
              <contentExtension pattern="org.eclipse.ui.navigator.resources.workingSets"/>
          </includes>
       </viewerContentBinding>
       <viewerActionBinding viewerId="com.treeage.treeagepro.ui.views.ProjectNavigator">
         <includes>
             <actionExtension pattern="org.eclipse.ui.navigator.resources.*" />
         </includes>
       </viewerActionBinding>
       <dragAssistant viewerId="com.treeage.treeagepro.ui.views.ProjectNavigator"
             class="org.eclipse.ui.navigator.resources.ResourceDragAdapterAssistant"/>
   </extension>

    <extension
            point="org.eclipse.ui.navigator.navigatorContent">
        <navigatorContent
                activeByDefault="true"
                contentProvider="com.treeage.treeagepro.ui.views.ProjectXContentProvider"
                icon="$nl$/icons/full/editor16/tree_package_obj.png"
                id="com.treeage.treeagepro.ui.packageContent"
                labelProvider="com.treeage.treeagepro.ui.views.ProjectXLabelProvider"
                name="%commonNavigatorContentName"
                priority="high">
             <triggerPoints>
                <or>
                   <and>
                      <instanceof value="org.eclipse.core.resources.IFile"/>
                      <test property="org.eclipse.core.resources.extension" value="projx"/>
                   </and>
                   <instanceof value="com.treeage.treeagepro.diagx.diagram.navigator.DiagxAbstractNavigatorItem"/>
                </or>
             </triggerPoints>
             <possibleChildren>
                <or>
                   <instanceof value="org.eclipse.core.resources.IFile"/>
                </or>
             </possibleChildren>
         <!--commonSorter 
               id="com.treeage.treeagepro.ui.diagram.navigatorSorter" 
               class="com.treeage.treeagepro.diagx.diagram.navigator.DiagxNavigatorSorter">
            <parentExpression>
               <or>
                  <and>
                     <instanceof value="org.eclipse.core.resources.IFile"/>
                     <test property="org.eclipse.core.resources.extension" value="diagx"/>
                  </and>
                  <instanceof value="com.treeage.treeagepro.diagx.diagram.navigator.DiagxAbstractNavigatorItem"/>
               </or>
            </parentExpression>
         </commonSorter-->
        </navigatorContent>
   </extension>
    
    <extension point="org.eclipse.ui.contexts">
       <context
             id="com.treeage.treeagepro.ui.editors.treeDiagramContext"
             name="TreeAge Pro Diagram Editor Context"
             parentId="org.eclipse.gmf.runtime.diagram.ui.diagramContext">
       </context>
       <context
             id="com.treeage.treeagepro.ui.editors.treeDiagramContext"
             name="TreeAge Pro External Subtree Editor Context"
             parentId="org.eclipse.gmf.runtime.diagram.ui.diagramContext">
       </context>
    </extension>
    
    <extension point="org.eclipse.gmf.runtime.emf.type.core.elementTypes">
        <metamodel nsURI="http://www.treeage.com/modeldefs/tree">
            <metamodelType id="tree.TreeDocument" name="Tree Document"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType" eclass="TreeDocument"
                edithelper="com.treeage.treeagepro.ui.editors.diagram.edithelpers.TreeDocumentEditHelper">
                <param name="semanticHint" value="TreeDocument" />
            </metamodelType>
            <specializationType id="tree.TreeDocument_Tree" name="Tree Document Tree"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeDocument" />
                <param name="semanticHint" value="TreeDocument_Tree" />
            </specializationType>
            <!--specializationType id="tree.TreeDocument_Node" name="Tree Document Node"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeDocument" />
                <param name="semanticHint" value="TreeDocument_Node" />
            </specializationType-->
            <metamodelType id="tree.TreeNode" name="Tree Node"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType" eclass="TreeNode"
                edithelper="com.treeage.treeagepro.ui.editors.diagram.edithelpers.TreeNodeEditHelper">
                <param name="semanticHint" value="TreeNode" />
            </metamodelType>
            <specializationType id="tree.TreeNode_Label" name="Tree Node Label"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_Label" />
            </specializationType>
            <specializationType id="tree.TreeNode_Probability" name="Tree Node Probability"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_Probability" />
            </specializationType>
            <specializationType id="tree.TreeNode_Variables" name="Tree Node Variables"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_Variables" />
            </specializationType>
            <specializationType id="tree.TreeNode_Payoff" name="Tree Node Payoff"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_Payoff" />
            </specializationType>
            <specializationType id="tree.TreeNode_Collapser" name="Tree Node Collapser"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_Collapser" />
            </specializationType>
            <specializationType id="tree.TreeNode_Comments_Flag" name="Tree Node Comments Flag"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_CommentsFlag" />
            </specializationType>
            <specializationType id="tree.TreeNode_CloneMasterIndex" name="Clone Master Index"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_CloneMasterIndex" />
            </specializationType>
            <specializationType
                  icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_ChanceNode.png"
                  id="tree.ChanceNode"
                  kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType"
                  name="Chance">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="ChanceNode" />
            </specializationType>
            <specializationType id="tree.TerminalNode" name="Terminal"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_TerminalNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TerminalNode" />
            </specializationType>
            <specializationType id="tree.DecisionNode" name="Decision"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DecisionNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="DecisionNode" />
            </specializationType>
            <specializationType id="tree.NadirNode" name="Nadir"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DecisionNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="NadirNode" />
            </specializationType>
            <specializationType id="tree.LogicNode" name="Logic"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_LogicNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="LogicNode" />
            </specializationType>
            <!-- or LabelNode -->
            <specializationType id="tree.TreeNode_ResourcePath" name="Tree Node Resource Path"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TreeNode_ResourcePath" />
            </specializationType>
            <specializationType id="tree.MarkovNode" name="Markov"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_MarkovNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="MarkovNode" />
            </specializationType>
            <specializationType id="tree.LabelNode" name="Label"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_LabelNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="LabelNode" />
            </specializationType>
            <specializationType id="tree.SummationNode" name="Summation"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_SummationNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="SummationNode" />
            </specializationType>
            <specializationType id="tree.DESNode" name="DES"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DESNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="DESNode" />
            </specializationType>
            <specializationType id="tree.TimeNode" name="Time"
                icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_TimeNode.png"
                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
                <specializes id="tree.TreeNode" />
                <param name="semanticHint" value="TimeNode" />
            </specializationType>
	        <specializationType id="tree.TreeExpectedValues" name="Tree Expected Values"
	                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
	             <specializes id="org.eclipse.gmf.runtime.emf.type.core.null"/>
	             <param name="semanticHint" value="TreeExpectedValues"/> 
	        </specializationType>
	        <specializationType id="tree.ExpectedValue" name="Expected Value"
	                kind="org.eclipse.gmf.runtime.emf.type.core.IHintedType">
	             <specializes id="org.eclipse.gmf.runtime.emf.type.core.null"/>
	             <param name="semanticHint" value="ExpectedValue"/> 
	        </specializationType>
        </metamodel>
    </extension>

    <extension point="org.eclipse.gmf.runtime.emf.type.core.elementTypeBindings">
        <clientContext id="tree.context">
            <enablement>
                <test property="org.eclipse.gmf.runtime.emf.core.editingDomain"
                    value="com.treeage.treeagepro.ui.editors.EditingDomain" />
            </enablement>
        </clientContext>
        <binding context="tree.context">
            <elementType pattern="tree.*" />
            <advice ref="org.eclipse.gmf.runtime.diagram.core.advice.notationDepdendents" />
        </binding>
    </extension>

    <extension point="org.eclipse.gmf.runtime.diagram.core.viewProviders">
        <viewProvider class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeViewProvider">
            <Priority name="Lowest" />
            <context viewClass="org.eclipse.gmf.runtime.notation.Diagram" semanticHints="TreeDocument" />
            <context viewClass="org.eclipse.gmf.runtime.notation.Node"
                semanticHints="TreeDocument_Tree,TreeDocument_Notes,TreeTables,TreeRoot,TreeNode,ChanceNode,TerminalNode,DecisionNode,LogicNode,MarkovNode,LabelNode,SummationNode,DESNode,TimeNode,TreeNode_ResourcePath,TreeNode_Label,TreeNode_Variables,TreeNode_Probability,TreeNode_Payoff,TreeNode_CloneMasterIndex,TreeNode_CommentsFlag,TreeNode_Collapser,ExpectedValue,Table" />
        </viewProvider>
    </extension>

    <extension point="org.eclipse.gmf.runtime.diagram.ui.editpartProviders">
       <editpartProvider
             class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeEditPartProvider">
          <Priority
                name="Medium">
          </Priority>
          <context providesRootEditPart="true"/>
       </editpartProvider>
    </extension>

    <extension point="org.eclipse.gmf.runtime.diagram.ui.paletteProviders">
        <paletteProvider class="org.eclipse.gmf.runtime.diagram.ui.providers.DefaultPaletteProvider">
            <Priority name="Highest" />
            <editor class="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor" />
            <contribution
                factoryClass="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgePalette$TreeNodeFactory">
                <entry id="nodes" kind="drawer" label="Tree Nodes" path="/">
                      <expand force="true"/>
                </entry>

                <!-- Use semantic hint as entry ID -->
                <entry label="Chance" kind="tool" path="/nodes/" id="ChanceNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_ChanceNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_ChanceNode.png" />
                <entry label="Terminal" kind="tool" path="/nodes/" id="TerminalNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_TerminalNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_TerminalNode.png" />
                <entry label="Decision" kind="tool" path="/nodes/" id="DecisionNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DecisionNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_DecisionNode.png" />
                <!--entry label="Decision" kind="tool" path="/standardGroup/" id="NadirNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_NadirNode.gif"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_NadirNode.gif" /-->
                <entry label="Logic" kind="tool" path="/nodes/" id="LogicNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_LogicNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_LogicNode.png" />
                <entry label="Markov" kind="tool" path="/nodes/" id="MarkovNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_MarkovNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_MarkovNode.png" />
                <entry label="Label" kind="tool" path="/nodes/" id="LabelNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_LabelNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_LabelNode.png" />
                <entry label="Summation" kind="tool" path="/nodes/" id="SummationNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_SummationNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_SummationNode.png" />
                <entry label="DES" kind="tool" path="/nodes/" id="DESNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_DESNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_DesNode.png" />
                <entry label="Time" kind="tool" path="/nodes/" id="TimeNode"
                    small_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool16/CreateTreeDocument_Nodes_TimeNode.png"
                    large_icon="platform:/plugin/com.treeage.model.tree.edit/icons/full/ctool24/CreateTreeDocument_Nodes_TimeNode.png" />
            </contribution>
            <contribution
                factoryClass="com.treeage.treeagepro.ui.editors.diagram.providers.TreeNotesAndArrowsPalette">
                <entry id="notes" kind="drawer" label="%page.label.notesAndArrows" path="/">
                      <expand force="true"/>
                </entry>

                <!-- Use semantic hint as entry ID -->
                <entry label="Note" kind="tool" path="/notes/" id="noteTool"  
                    small_icon="platform:/plugin/org.eclipse.gmf.runtime.diagram.ui.providers/icons/note.gif"
                    large_icon="platform:/plugin/org.eclipse.gmf.runtime.diagram.ui.providers/icons/note_24x24.gif"/>
                <entry label="Arrow" kind="tool" path="/notes/" id="noteattachmentTool"  
                    small_icon="icons/full/pal/arrow_16.gif"
                    large_icon="icons/full/pal/arrow_24.gif"/>
            </contribution>
            <contribution>
                <predefinedEntry id="standardGroup/noteStack/noteTool" remove="true" />
                <predefinedEntry id="standardGroup/noteStack/textTool" remove="true" />
                <predefinedEntry id="standardGroup/noteStack/noteattachmentTool" remove="true" />
            </contribution>
        </paletteProvider>
    </extension>

    <extension point="org.eclipse.gmf.runtime.common.ui.services.iconProviders">
        <IconProvider class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeIconProvider">
            <Priority name="Lowest" />
        </IconProvider>
    </extension>

    <extension point="org.eclipse.gmf.runtime.common.ui.services.parserProviders">
        <ParserProvider class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeParserProvider">
            <Priority name="Medium" />
        </ParserProvider>
    </extension>

    <extension point="org.eclipse.gmf.runtime.common.ui.services.properties.propertiesProviders"
        id="treeagepro.providers.TreeNodeCustomPropertiesProvider">
        <PropertiesProvider class="com.treeage.treeagepro.ui.properties.providers.TreeNodeCustomPropertiesProvider">
            <Priority name="Medium" />
        </PropertiesProvider>
        <PropertiesProvider class="com.treeage.treeagepro.ui.properties.providers.TreeDocumentCustomPropertiesProvider">
            <Priority name="Medium" />
        </PropertiesProvider> 
    </extension>
    
    <extension point="org.eclipse.gmf.runtime.diagram.core.diagramEventBrokerProviders"
        id="treeagepro.providers.DiagramEventBrokerProvider">
        <diagramEventBrokerProvider class="com.treeage.treeagepro.ui.editors.diagram.providers.DiagramEventBrokerProvider">
            <Priority name="Medium"/>
            <editingDomain ID="com.treeage.treeagepro.ui.editors.EditingDomain"/>
        </diagramEventBrokerProvider> 
    </extension>
    
    <extension point="org.eclipse.gmf.runtime.emf.clipboard.core.clipboardSupport">
        <factory
            class="com.treeage.treeagepro.ui.editors.diagram.providers.NotationClipboardSupportExt$Factory"
            nsURI="http://www.eclipse.org/gmf/runtime/1.0.1/notation"
            priority="medium">
        </factory>
    </extension>
    
    <extension point="org.eclipse.gmf.runtime.common.ui.services.action.globalActionHandlerProviders">
        <GlobalActionHandlerProvider id="treeagepro.diagramGlobalActionHandler.edit"
            class="com.treeage.treeagepro.ui.editors.diagram.providers.EditDiagramGlobalActionHandler$Provider">
            <Priority name="Lowest" />
            <ViewId id="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">
                <ElementType>
                    <GlobalActionId actionId="cut" />
                    <GlobalActionId actionId="copy" />
                    <GlobalActionId actionId="paste" />
                    <GlobalActionId actionId="delete" />
                </ElementType>
            </ViewId>
            <ViewId id="com.treeage.treeagepro.ui.views.Explorer">
                <ElementType>
                    <GlobalActionId actionId="cut" />
                    <GlobalActionId actionId="copy" />
                    <GlobalActionId actionId="paste" />
                    <GlobalActionId actionId="delete" />
                </ElementType>
            </ViewId>
        </GlobalActionHandlerProvider>
        <GlobalActionHandlerProvider id="treeagepro.diagramGlobalActionHandler.print"
            class="com.treeage.treeagepro.ui.editors.diagram.providers.PrintDiagramGlobalActionHandler$Provider">
            <Priority name="Lowest" />
            <ViewId id="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">
                <ElementType>
                    <GlobalActionId actionId="print" />
                </ElementType>
            </ViewId>
        </GlobalActionHandlerProvider>
    </extension>
    
    <extension
       id="popupMenus"
       point="org.eclipse.ui.popupMenus">
       <viewerContribution
          id="com.treeage.treeagepro.ui.subtree"
          targetID="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeEditor">
          <menu
                id="top"
                label="top"
                path="com.treeage.treeagepro.ui.subtree">
                <groupMarker name="main"/>
                <separator name="additions"/>
          </menu>
          <menu
                id="insertNodeMenu"
                label="%subtree.menu.label.insertNodeMenu"
                path="top">
                <groupMarker name="main"/>
          </menu>
          <menu
                id="changeTypeMenu"
                label="%subtree.menu.label.changeTypeMenu"
                path="top">
                <groupMarker name="main"/>
          </menu>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.AddBranchAction"
                id="addBranch"
                enablesFor="1"
                menubarPath="top"
                label="%subtree.menu.label.addBranch"
                definitionId="treeagepro.ui.subtree.addBranch">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNode"
                enablesFor="1"
                menubarPath="insertNodeMenu/main"
                label="%subtree.menu.label.insertNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeLeft"
                enablesFor="1"
                menubarPath="insertNodeMenu/main"
                label="%subtree.menu.label.insertNodeLeft">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeRight"
                enablesFor="1"
                menubarPath="insertNodeMenu/main"
                label="%subtree.menu.label.insertNodeRight">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeAbove"
                enablesFor="1"
                menubarPath="insertNodeMenu/main"
                label="%subtree.menu.label.insertNodeAbove">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeBelow" 
                enablesFor="1"
                menubarPath="insertNodeMenu/main"
                label="%subtree.menu.label.insertNodeBelow">
          </action>          
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToChanceNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToChanceNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToTerminalNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToTerminalNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToDecisionNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToDecisionNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToLogicNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToLogicNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToMarkovNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToMarkovNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToLabelNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToLabelNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToSummationNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToSummationNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToDESNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToDESNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToTimeNode" 
                enablesFor="1"
                menubarPath="changeTypeMenu/main"
                label="%subtree.menu.label.changeTypeToTimeNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.DeleteNodesAction"
                id="delete" 
                enablesFor="*"
                menubarPath="additions"
                label="%subtree.menu.label.delete"
                definitionId="org.eclipse.ui.edit.delete">
          </action>
       </viewerContribution>
       
       <viewerContribution
          id="com.treeage.treeagepro.ui.subtree.insertNode"
          targetID="insertNodeMenu">
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeLeft"
                enablesFor="1"
                menubarPath="com.treeage.treeagepro.ui.subtree.insertNode"
                label="%subtree.menu.label.insertNodeLeft">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeRight"
                enablesFor="1"
                menubarPath="com.treeage.treeagepro.ui.subtree.insertNode"
                label="%subtree.menu.label.insertNodeRight">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeAbove"
                enablesFor="1"
                menubarPath="com.treeage.treeagepro.ui.subtree.insertNode"
                label="%subtree.menu.label.insertNodeAbove">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.InsertNodeAction"
                id="insertNodeBelow" 
                enablesFor="1"
                menubarPath="com.treeage.treeagepro.ui.subtree.insertNode"
                label="%subtree.menu.label.insertNodeBelow">
          </action>
       </viewerContribution>

       <viewerContribution
          id="com.treeage.treeagepro.ui.subtree.changeType"
          targetID="changeTypeMenu">
          <!--TODO Disable actively for selection context/-->
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToChanceNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToChanceNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToTerminalNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToTerminalNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToDecisionNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToDecisionNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToLogicNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToLogicNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToMarkovNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToMarkovNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToLabelNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToLabelNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToSummationNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToSummationNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToDESNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToDESNode">
          </action>
          <action
                class="com.treeage.treeagepro.ui.editors.subtree.actions.ChangeTypeAction"
                id="changeTypeToTimeNode" 
                enablesFor="+"
                menubarPath="com.treeage.treeagepro.ui.subtree.changeType"
                label="%subtree.menu.label.changeTypeToTimeNode">
          </action>
       </viewerContribution>
    </extension>
    
    <extension point="org.eclipse.gmf.runtime.common.ui.services.action.contributionItemProviders">
        <contributionItemProvider
            class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeDiagramContributionItemProvider"
            checkPluginLoaded="false">
            <Priority name="Low"/>
            <partContribution>
                <partAction id="cut" global="true" />
                <partAction id="copy" global="true" />
                <partAction id="paste" global="true" />
                <partAction id="delete" global="true" />
                <partAction id="print" global="true" />
            </partContribution>
            <partContribution class="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">
                <!-- Display -->
                <!-- partMenuGroup menubarPath="/treeagepro.app.display/" id="changeGenerationGroup" -->
                <!-- partAction menubarPath="/treeagepro.app.display/changeGenerationGroup" id="skipGeneration"  -->
                <!-- partAction menubarPath="/treeagepro.app.display/changeGenerationGroup" id="unskipGeneration" -->
                <!-- partMenuGroup menubarPath="/treeagepro.app.display/" id="collapsingGroup" -->
                <!-- partAction menubarPath="/treeagepro.app.display/collapsingGroup" id="collapseSubtree" -->
                <!-- partAction menubarPath="/treeagepro.app.display/collapsingGroup" id="expandSubtreeOnce" -->
                <!-- partAction menubarPath="/treeagepro.app.display/collapsingGroup" id="expandEntireSubtree" -->
                <!-- partAction menubarPath="/treeagepro.app.options/changeOptimalPathGroup" id="changeOptimalPath" -->
            </partContribution>
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupMenuGroup id="values" />
                <popupMenuGroup id="top" />
                <popupMenuGroup id="probability" />
                <popupMenuGroup id="select" />
                <popupMenuGroup id="subtree" />
                <popupMenuGroup id="clipboard" />
                <popupMenuGroup id="edit" />
            </popupContribution>

            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria 
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="1" />
                <popupMenu path="/values" id="defineVariableMenu" />
                <popupMenu path="/values" id="defineTrackerMenu" />
                <popupAction path="/top" id="addBranch" />
                <popupAction path="/top" id="excludeStrategy" />
                <popupMenu path="/top" id="insertNodeMenu" />
                <popupMenuGroup path="/insertNodeMenu/" id="main" />
                <popupMenuGroup path="/insertNodeMenu/" id="additions" />
                <popupAction path="/insertNodeMenu/main" id="insertNodeLeft" />
                <popupAction path="/insertNodeMenu/main" id="insertNodeRight" />
                <popupAction path="/insertNodeMenu/main" id="insertNodeAbove" />
                <popupAction path="/insertNodeMenu/main" id="insertNodeBelow" />
                <popupAction path="/select" id="selectSubtree" />
                <popupAction path="/select" id="convertToSTD" />
            </popupContribution>

            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria 
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="1"
                    policyClass="com.treeage.treeagepro.ui.editors.diagram.actions.EditProbabilityAction$AllowEditProbabilityPolicy"/>
                <popupAction path="/probability" id="editProbability" />
            </popupContribution>

            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria 
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="1"
                    policyClass="com.treeage.treeagepro.ui.editors.diagram.actions.EditProbabilityAction$AllowSetComplementProbabilityPolicy"/>
                <popupAction path="/probability" id="editProbabilityComplement" />
            </popupContribution>

            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria 
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="1"
                    policyClass="com.treeage.treeagepro.ui.editors.diagram.actions.EditProbabilityAction$AllowEditChildrenProbabilityPolicy"/>
                <popupAction path="/probability" id="editProbabilityChildren" />
            </popupContribution>
            
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria 
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="+" />
                <popupMenu path="/top" id="changeTypeMenu" />
                <popupMenuGroup path="/changeTypeMenu/" id="main" />
                <popupMenuGroup path="/changeTypeMenu/" id="additions" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToChanceNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToTerminalNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToDecisionNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToLogicNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToMarkovNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToLabelNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToSummationNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToDESNode" />
                <popupAction path="/changeTypeMenu/main" id="changeTypeToTimeNode" />
                <popupMenu path="/top" id="changeProbFlexMenu" />
                <popupMenuGroup path="/changeProbFlexMenu/" id="main" />
                <popupAction path="/changeProbFlexMenu/main" id="changeFlexToDefault" />
                <popupAction path="/changeProbFlexMenu/main" id="changeFlexToAllow" />
                <popupAction path="/changeProbFlexMenu/main" id="changeFlexToNotAllow" />
                <popupAction path="/changeProbFlexMenu/main" id="changeFlexToNormalize" />
			</popupContribution>
			
			<popupContribution class="org.eclipse.gmf.runtime.diagram.ui.providers.DiagramContextMenuProvider">
                <popupPredefinedItem
                      path="/formatMenu/" id="fontDialogAction"
                      remove="true">
                </popupPredefinedItem>
                <popupPredefinedItem
                      path="/formatMenu/" id="alignMenu"
                      remove="true">
                </popupPredefinedItem>
                <popupPredefinedItem
                      path="/formatMenu/" id="arrangeMenu"
                      remove="true">
                </popupPredefinedItem>
             </popupContribution>
             
            <!-- Terminal node menu items -->
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria  
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="+">
                    <method
                          name="getModel().getType()" 
                          value="TerminalNode">
                    </method>
                </popupStructuredContributionCriteria>
                <popupAction path="/values" id="showPayoffs" />
            </popupContribution>
            
            <!-- Subtree menu items -->
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria  
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="1">
                    <method
                          name="getModel().getType()"
                          value="LabelNode">
                    </method>
                </popupStructuredContributionCriteria>
                <popupAction path="/subtree" id="detachSubtree" />
                <popupAction path="/subtree" id="addSubtree" />
            </popupContribution>
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="1">
                    <method
                          name="isExternalSubtreeNode()"
                          value="true">
                    </method>
                </popupStructuredContributionCriteria>
                <popupAction path="/subtree" id="attachSubtree" />
                <popupAction path="/subtree" id="loadSubtree" />
                <popupAction path="/subtree" id="unloadSubtree" />
            </popupContribution>
            <!-- -->
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria
                    objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="+"/>
                <popupMenu path="/additions" id="nodeFontMenu" />
                <popupMenuGroup path="/nodeFontMenu/" id="main" />
                <popupMenuGroup path="/nodeFontMenu/" id="additions" />
                <popupAction path="/nodeFontMenu/main" id="nodeLabelFontDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="nodeLabelFontColorDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="probabilityFontDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="probabilityFontColorDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="evFontDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="evFontColorDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="variablesFontDialogAction" />
                <popupAction path="/nodeFontMenu/main" id="variablesFontColorDialogAction" />
            </popupContribution>
            
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupStructuredContributionCriteria
                    objectClass="org.eclipse.gmf.runtime.diagram.ui.editparts.NoteEditPart"/>
                <popupAction path="/additions" id="notesFontDialogAction"/>
                <popupAction path="/additions" id="notesFontColorDialogAction"/>
            </popupContribution>
            
            <popupContribution class="com.treeage.treeagepro.ui.editors.diagram.providers.TreeAgeDiagramContextMenuProvider">
                <popupAction path="/clipboard" id="cut" />
                <popupAction path="/clipboard" id="copy" />
                <popupAction path="/clipboard" id="paste" />
                <popupAction path="/edit" id="delete" />
            </popupContribution>

             <popupContribution class="org.eclipse.gmf.runtime.diagram.ui.providers.DiagramContextMenuProvider">
                <popupStructuredContributionCriteria objectClass="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart"
                    objectCount="+">
                    <method name="getParent().isRollbackMode()" value="true"/>
                </popupStructuredContributionCriteria>
                <popupAction path="/select" id="rollBackBoxToggle"/>
             </popupContribution>
        </contributionItemProvider>
    </extension>
    
    <extension point="org.eclipse.ui.views.properties.tabbed.propertyContributor">
        <propertyContributor contributorId="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">
            <propertyCategory category="visual" />
        </propertyContributor>
        <propertyContributor contributorId="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeEditor">
            <propertyCategory category="visual" />
        </propertyContributor>
    </extension>

    <extension point="org.eclipse.ui.views.properties.tabbed.propertyTabs">
        <propertyTabs contributorId="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">
            <!-- 
              - Tree Properties tabs must start with "tree." prefix.
              - Node Properties tabs - with "node." prefix. 
              -->
            <propertyTab afterTab="20" category="visual" id="tree.General" label="%propertyTab.label.general" />
            <propertyTab afterTab="30" category="visual" id="tree.Variables" label="%propertyTab.label.variables" />
            <propertyTab afterTab="45" category="visual" id="tree.Trackers" label="%propertyTab.label.trackers" />
            <propertyTab afterTab="50" category="visual" id="tree.Tables" label="%propertyTab.label.tables" />
            <propertyTab afterTab="55" category="visual" id="tree.Distributions" label="%propertyTab.label.distributions" />
            <propertyTab afterTab="60" category="visual" id="tree.Clones" label="%propertyTab.label.clones" />
            <propertyTab afterTab="85" category="visual" id="treeVariables.Properties" label="%propertyTab.label.variables" />
            <propertyTab afterTab="90" category="visual" id="treeTrackers.Properties" label="%propertyTab.label.trackers" />
            <propertyTab afterTab="95" category="visual" id="treeTables.Properties" label="%propertyTab.label.tables" />
            <propertyTab afterTab="100" category="visual" id="treeDistributions.Properties" label="%propertyTab.label.distributions" />
            <propertyTab afterTab="100" category="visual" id="treeClones.Properties" label="%propertyTab.label.clones" />
            
            <propertyTab afterTab="10" category="visual" id="node.General" label="%propertyTab.label.general" />
            <propertyTab afterTab="20" category="visual" id="node.Variables" label="%propertyTab.label.variables" />
            <propertyTab afterTab="25" category="visual" id="node.Trackers" label="%propertyTab.label.trackers" />
            <propertyTab afterTab="35" category="visual" id="node.MarkInfo" label="%propertyTab.label.markov" />
            <propertyTab afterTab="37" category="visual" id="node.DESInfo" label="%propertyTab.label.DES" />
            <propertyTab afterTab="40" category="visual" id="node.MarkBinds" label="%propertyTab.label.stateBindings" />
            <propertyTab afterTab="55" category="visual" id="node.Distributions" label="%propertyTab.label.distributions" />
            <propertyTab afterTab="65" category="visual" id="nodeMarkInfo.Properties" label="%propertyTab.label.markov" />
            <propertyTab afterTab="67" category="visual" id="nodeDESInfo.Properties" label="%propertyTab.label.DES" />
            <propertyTab afterTab="70" category="visual" id="nodeMarkBinds.Properties" label="%propertyTab.label.stateBindings" />
            <propertyTab afterTab="75" category="visual" id="nodeVariables.Definitions" label="%propertyTab.label.definitions" />
            <propertyTab afterTab="80" category="visual" id="nodeTrackers.Modifications" label="%propertyTab.label.modifications" />
            <propertyTab
                  afterTab="10"
                  category="visual"
                  id="player.analysis"
                  label="%propertyTab.label.availableAnalysis">
            </propertyTab>
            <propertyTab
                  afterTab="10"
                  category="visual"
                  id="player.design"
                  label="%propertyTab.label.playerDesign">
            </propertyTab>
        </propertyTabs>

        <!-- Properteies sheets for external subtree editor --> 
        <propertyTabs contributorId="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeEditor">
            <!-- 
              - Tree Properties tabs must start with "tree." prefix.
              - Node Properties tabs - with "node." prefix. 
              -->
            <propertyTab afterTab="15" category="visual" id="tree.General" label="%propertyTab.label.general" />
            <propertyTab afterTab="30" category="visual" id="tree.Variables" label="%propertyTab.label.variables" />
            <propertyTab afterTab="45" category="visual" id="tree.Trackers" label="%propertyTab.label.trackers" />
            <propertyTab afterTab="50" category="visual" id="tree.Tables" label="%propertyTab.label.tables" />
            <propertyTab afterTab="55" category="visual" id="tree.Distributions" label="%propertyTab.label.distributions" />
            <propertyTab afterTab="85" category="visual" id="treeVariables.Properties" label="%propertyTab.label.variables" />
            <propertyTab afterTab="90" category="visual" id="treeTrackers.Properties" label="%propertyTab.label.trackers" />
            <propertyTab afterTab="95" category="visual" id="treeTables.Properties" label="%propertyTab.label.tables" />
            <propertyTab afterTab="100" category="visual" id="treeDistributions.Properties" label="%propertyTab.label.distributions" />
            
            <propertyTab afterTab="10" category="visual" id="node.General" label="%propertyTab.label.general" />
            <propertyTab afterTab="20" category="visual" id="node.Variables" label="%propertyTab.label.variables" />
            <propertyTab afterTab="25" category="visual" id="node.Trackers" label="%propertyTab.label.trackers" />
            <propertyTab afterTab="35" category="visual" id="node.MarkInfo" label="%propertyTab.label.markov" />
            <propertyTab afterTab="37" category="visual" id="node.DESInfo" label="%propertyTab.label.DES" />
            <propertyTab afterTab="40" category="visual" id="node.MarkBinds" label="%propertyTab.label.stateBindings" />
            <propertyTab afterTab="55" category="visual" id="node.Distributions" label="%propertyTab.label.distributions" />
            <propertyTab afterTab="65" category="visual" id="nodeMarkInfo.Properties" label="%propertyTab.label.markov" />
            <propertyTab afterTab="67" category="visual" id="nodeDESInfo.Properties" label="%propertyTab.label.DES" />
            <propertyTab afterTab="70" category="visual" id="nodeMarkBinds.Properties" label="%propertyTab.label.stateBindings" />
            <propertyTab afterTab="75" category="visual" id="nodeVariables.Definitions" label="%propertyTab.label.definitions" />
            <propertyTab afterTab="80" category="visual" id="nodeTrackers.Modifications" label="%propertyTab.label.modifications" />
        </propertyTabs>
    </extension>
    
    <extension point="org.eclipse.ui.views.properties.tabbed.propertySections">

        <propertySections contributorId="com.treeage.treeagepro.ui.editors.diagram.TreeDiagramEditor">

            <!-- Tree sections combined -->
            <propertySection id="property.section.General" tab="tree.General"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.GeneralSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
            
            <propertySection id="property.section.VariablesTree" tab="tree.Variables"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeVariablesSection"
                enablesFor="1">
                <!-- This section depends on both TreeDocument and TreeNode -->
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart" />
            </propertySection>
            
            <propertySection id="property.section.Trackers" tab="tree.Trackers"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTrackersSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>

            <propertySection id="property.section.TreeDistributions" tab="tree.Distributions"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.DistributionsSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
            
            <propertySection id="property.section.NodeDistributions" tab="node.Distributions"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.DistributionsSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart" />
            </propertySection>
            
            <propertySection id="property.section.Tables" tab="tree.Tables"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTablesSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
            
            <propertySection id="property.section.Clones" tab="tree.Clones"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.ClonesSection"
                enablesFor="-1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
            
            <!-- Tree sections separated -->

            <propertySection id="property.section.VariablesTree" tab="treeVariables.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeVariablesSection"
                enablesFor="1">
                <!-- This section depends on both TreeDocument and TreeNode -->
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart" />
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
 			            
            <propertySection id="property.section.Tables" tab="treeTables.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTablesSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>

            <propertySection id="property.section.Distributions" tab="treeDistributions.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.DistributionsSection"
                enablesFor="1">
                <!-- This section depends on both TreeDocument and TreeNode -->
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart" />
            </propertySection>
            
            <propertySection id="property.section.Trackers" tab="treeTrackers.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTrackersSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
            
            <propertySection id="property.section.Clones" tab="treeClones.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.ClonesSection"
                enablesFor="-1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart" />
            </propertySection>
            
            <!-- Node sections combined -->
            <propertySection id="property.section.General" tab="node.General"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.GeneralSection"
                enablesFor="1">
                <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeNodeEditPart" />
            </propertySection>
            
            <propertySection id="property.section.VariablesNode" tab="node.Variables"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.variables.VariablesNodeSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.TrackersNode" tab="node.Trackers"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.trackers.NodeTrackersSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.MarkInfo" tab="node.MarkInfo"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>

            <propertySection id="property.section.MarkInfo" tab="node.DESInfo"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.DESSubtreeNodePropsSection">
            </propertySection>
            
            <propertySection id="property.section.MarkBinds" tab="node.MarkBinds"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovBindsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>     
            
            <!-- Node sections separated -->
            <propertySection id="property.section.VariablesNode" tab="nodeVariables.Definitions"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.variables.VariablesNodeSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.TrackersNode" tab="nodeTrackers.Modifications"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.trackers.NodeTrackersSection"
               filter="org.eclipse.jface.viewers.AcceptAllFilter">               
            </propertySection>
            
            <propertySection id="property.section.MarkInfo" tab="nodeMarkInfo.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>

            <propertySection id="property.section.MarkInfo" tab="nodeDESInfo.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.DESSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>

 			<propertySection id="property.section.MarkBinds" tab="nodeMarkBinds.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovBindsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection
                  class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.player.PlayerModeSection"
                  id="property.section.playerAnalysis" tab="player.analysis">
               <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart"/>
            </propertySection>
            
            <propertySection
                  class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.player.PlayerDesignSection"
                  id="property.section.playerDesign" tab="player.design">
               <input type="com.treeage.treeagepro.ui.editors.diagram.editparts.TreeDocumentEditPart"/>
            </propertySection>
            
        </propertySections>
        
        <!-- External subtree properties sections -->
        <propertySections contributorId="com.treeage.treeagepro.ui.editors.subtree.ExternalSubtreeEditor">
            <!-- Tree sections combined -->
            <propertySection id="property.section.General" tab="tree.General"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.GeneralSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
            
            <propertySection id="property.section.VariablesTree" tab="tree.Variables"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeVariablesSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeNode" />
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
            
            <propertySection id="property.section.Trackers" tab="tree.Trackers"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTrackersSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
            
            <propertySection id="property.section.TreeDistributions" tab="tree.Distributions"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.DistributionsSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>

            <propertySection id="property.section.NodeDistributions" tab="node.Distributions"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.DistributionsSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeNode" />
            </propertySection>

            <propertySection id="property.section.Tables" tab="tree.Tables"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTablesSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
            
            <!-- Tree sections separated -->
            <propertySection id="property.section.VariablesTree" tab="treeVariables.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeVariablesSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeNode" />
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
                        
            <propertySection id="property.section.Tables" tab="treeTables.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTablesSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>

            <propertySection id="property.section.Distributions" tab="treeDistributions.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.DistributionsSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeNode" />
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
            
            <propertySection id="property.section.Trackers" tab="treeTrackers.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.TreeTrackersSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeDocument" />
            </propertySection>
            
            <!-- Node sections combined -->
            <propertySection id="property.section.General" tab="node.General"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.GeneralSection"
                enablesFor="1">
                <input type="com.treeage.model.tree.TreeNode" />
            </propertySection>
            
            <propertySection id="property.section.VariablesNode" tab="node.Variables"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.variables.VariablesNodeSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.TrackersNode" tab="node.Trackers"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.trackers.NodeTrackersSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">                
            </propertySection>
            
            <propertySection id="property.section.MarkInfo" tab="node.MarkInfo"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.MarkInfo" tab="node.DESInfo"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.MarkBinds" tab="node.MarkBinds"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovBindsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>     
            
            <!-- Node sections separated -->
            <propertySection id="property.section.VariablesNode" tab="nodeVariables.Definitions"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.variables.VariablesNodeSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.TrackersNode" tab="nodeTrackers.Modifications"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.node.trackers.NodeTrackersSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
            
            <propertySection id="property.section.MarkInfo" tab="nodeMarkInfo.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>

            <propertySection id="property.section.MarkInfo" tab="nodeDESInfo.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovSubtreeNodePropsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>

            <propertySection id="property.section.MarkBinds" tab="nodeMarkBinds.Properties"
                class="com.treeage.treeagepro.ui.editors.diagram.sheets.markov.MarkovBindsSection"
                filter="org.eclipse.jface.viewers.AcceptAllFilter">
            </propertySection>
        </propertySections>
    </extension>
    
    <extension point="org.eclipse.search.searchPages">
	   <page id="com.treeage.treeagepro.ui.search"
			icon="icons/full/view16/search_nodes.png"
			label="%page.label.searchOpenTrees"
			showScopeSection="false"
			enabled="true" 
			tabPosition="0" 
			class="com.treeage.treeagepro.ui.search.SearchDialog">
		</page>
	</extension>
	
    <extension point="org.eclipse.search.searchResultViewPages">
 		<viewPage id="com.treeage.treeagepro.ui.search.SearchResultPage"
  			searchResultClass="com.treeage.treeagepro.ui.search.SearchResult"
  			class="com.treeage.treeagepro.ui.search.SearchResultPage"
  			label="%page.label.treeNodeSearchResult">
 		</viewPage>
	</extension>

<!--	
	<extension point="org.eclipse.ui.intro"> 
      <intro class="com.treeage.treeagepro.ui.views.Intro"
            id="treeage.introView"
            />
      <introProductBinding
            introId="treeage.introView"
            productId="com.treeage.treeagepro.app.product">
      </introProductBinding>
    </extension>
-->

   <extension
         point="org.eclipse.ui.intro">
      <intro
            class="org.eclipse.ui.intro.config.CustomizableIntroPart"
            id="treeage.intro">
      </intro>
      <introProductBinding
            introId="treeage.intro"
            productId="com.treeage.treeagepro.ui.product">
      </introProductBinding>
   </extension>

   <extension
         point="org.eclipse.ui.intro.config">
         <!-- maybe $nl$/introContent.xml ? -->
      <config
            introId="treeage.intro"
            content="introContent.xml"
            id="treeage.configId">
         <presentation
               home-page-id="root" standby-page-id="standby">
            <implementation
                  kind="html"
                  os="win32,linux,macosx">
            </implementation>
         </presentation>
      </config>
   </extension>
   
	<!-- TODO Phase 6 Pestunov use org.eclipse.ui.actionSets extension point -->
    <extension point="org.eclipse.ui.menus">
        <menuContribution locationURI="menu:treeagepro.app.edit?after=additionsGroup">
            <separator name="valuesPrefsGroup" visible="true"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.editLinksPreferences"
             label="%command.label.editLinksPreferences">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <separator name="prefsGroup" visible="true"/>
            <command
                  commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
                  label="%menu.label.treePreferences">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command
                  commandId="com.treeage.treeagepro.ui.diagram.editTreeNumericFormatPreferences"
                  icon="icons/etool16/numeric_preferences.png">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.enterDesignerPassword"
                 label="%command.label.enterDesignerPassword"
                 style="push">
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditorSelected">
                 </reference>
              </visibleWhen>
           </command>
        </menuContribution>
        
        <menuContribution locationURI="menu:treeagepro.app.analysis?after=additionsGroup">
            <separator name="rollbackGroup" visible="true"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.rollBack"
                   icon="icons/etool16/rollback.png"
                   label="%menu.label.rollBack" style="toggle">
               <visibleWhen>
                   <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
               </visibleWhen>
            </command>
            <separator name="reportsGroup" visible="true"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.expectedValue"
                label="%menu.label.expectedValue">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.EVPI"
                label="%menu.label.EVPI">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.standardDeviation"
                label="%menu.label.standardDeviation">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.pathProbability"
                label="%menu.label.pathProbability">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.payoffRange"
                label="%menu.label.payoffRange">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.overUnderProbabilities"
                label="%menu.label.overUnderProbabilities">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
        </menuContribution>
        
        <menuContribution locationURI="menu:treeagepro.app.tree">
            <separator name="additionsGroup" visible="true"/>
        </menuContribution>
        <menuContribution
              locationURI="menu:treeagepro.app.node?after=additionsGroup">
           <separator
                 name="changeGenerationGroup"
                 visible="true">
           </separator>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.skipGeneration">
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.unskipGeneration">
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.changeOptimalPath">
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                 </reference>
              </visibleWhen>
           </command>
            <command commandId="org.eclipse.ui.views.showView"
                label="%command.label.showAllWheel"
                icon="platform:/plugin/com.treeage.treeagepro.ui/icons/full/view16/probability_wheel.png">
                <parameter
                      name="org.eclipse.ui.views.showView.viewId"
                      value="com.treeage.treeagepro.ui.views.ProbabilityView" />
                 <visibleWhen>
                       <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>                      
            </command>
            <command
                 commandId="com.treeage.treeagepro.ui.diagram.command.nodeComments"
                label="%command.label.nodeBranchComments"
                 icon="platform:/plugin/com.treeage.treeagepro.ui/icons/etool16/comment.png">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
           <separator
                 name="changeGenerationEndGroup"
                 visible="true">
           </separator>
        </menuContribution>
        
        <menuContribution
              locationURI="menu:treeagepro.app.subtree?after=additionsGroup">
            <separator name="clonesGroup" visible="true"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.createOrDestroyCloneMaster">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.attachOrDetachClone">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <separator name="collapsingGroup" visible="true"/>
            <command commandId="com.treeage.treeagepro.ui.diagram.collapseSubtree">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.expandSubtreeOnce">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
            <command commandId="com.treeage.treeagepro.ui.diagram.expandEntireSubtree">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>

            <separator name="wizardsGroup" visible="true"/>
            <menu
                  label="%menu.label.bayes">
               <command
                     commandId="com.treeage.treeagepro.ui.diagram.command.subtreeBayesRevision">
                  <visibleWhen>
                     <reference
                           definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                     </reference>
                  </visibleWhen>
               </command>
               <command
                     commandId="com.treeage.treeagepro.ui.diagram.command.subtreeBayesRevisionWizard">
                  <visibleWhen>
                     <reference
                           definitionId="treeagepro.ui.isActiveTreeDiagramEditor">
                     </reference>
                  </visibleWhen>
               </command>
            </menu>
            <command commandId="com.treeage.treeagepro.ui.diagram.command.convertToSTD">
                <visibleWhen>
                    <reference definitionId="treeagepro.ui.isActiveTreeDiagramEditor"/>
                </visibleWhen>
            </command>
        </menuContribution>

        <menuContribution
              locationURI="menu:treeagepro.app.file?after=saveImageGroupEnd">
            <separator name="dynamicDocGroup" visible="false"/>
            <menu label="%command.label.modelDoc">
                <menu label="%command.label.createDoc">
                    <command commandId="com.treeage.treeagepro.ui.createDoc" 
                        label="%command.label.createDoc.template1">
                        <parameter name="template" value="ModelDocs"/>
                        <parameter name="fileName" value="template1.xls"/>
                    </command>
                    <command commandId="com.treeage.treeagepro.ui.createDoc"
                         label="%command.label.createDoc.templateCETree">
                        <parameter name="template" value="ModelDocs"/>
                        <parameter name="fileName" value="template-ce-tree.xls"/>
                    </command>
                    <command commandId="com.treeage.treeagepro.ui.createDoc" 
                        label="%command.label.createDoc.templateCEMarkov">
                        <parameter name="template" value="ModelDocs"/>
                        <parameter name="fileName" value="template-ce-markov.xls"/>
                    </command>
                	<separator name="createDocAppend" visible="false"/>
                </menu>
                <command commandId="com.treeage.treeagepro.ui.saveDocAs" 
                    label="%command.label.saveDocAs" />
                <command commandId="com.treeage.treeagepro.ui.openSpreadsheetDoc"
                      label="%command.label.openSpreadsheetDoc">
                </command>
            </menu>
        </menuContribution>
        <menuContribution
              allPopups="false"
              locationURI="toolbar:com.treeage.treeagepro.ui.views.PlayerDesign?after=additions">
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.editStoredAnalysesPreferences"
                 icon="icons/full/stored/abstract.gif"
                 style="push">
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditorUnlocked">
                 </reference>
              </visibleWhen>
           </command>
           <command
                 commandId="com.treeage.treeagepro.ui.diagram.enterDesignerPassword"
                 label="%command.label.enterDesignerPassword"
                 style="push">
              <visibleWhen>
                 <reference
                       definitionId="treeagepro.ui.isActiveTreeDiagramEditorSelected">
                 </reference>
              </visibleWhen>
           </command>
        </menuContribution>
    </extension>

    <extension point="org.eclipse.ui.bindings">
        <key 
            commandId="org.eclipse.ui.views.showView"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+D">
            <parameter
                id="org.eclipse.ui.views.showView.viewId"
                value="com.treeage.treeagepro.ui.views.VariableProperties" />
        </key>
        <key
            commandId="org.eclipse.ui.navigate.back"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="ALT+ARROW_LEFT"/>
        <key
            commandId="org.eclipse.ui.navigate.forward"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="ALT+ARROW_RIGHT"/>        
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.selectRoot"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+HOME"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.insertNode" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+I"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.insertNode" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="INSERT"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeLeft" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+I L"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeRight" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+I R"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeAbove" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+I A"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.insertNodeBelow" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+I B"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeType" 
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToSummationNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T S"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToChanceNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T C"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToTerminalNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T T"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToDecisionNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T D"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToMarkovNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T M"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToLogicNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T L"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToLabelNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T B"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToDESNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T E"/>
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.changeTypeToTimeNode"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+T I"/>
        <key 
            commandId="org.eclipse.ui.window.activateEditor"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+F12">
        </key>
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.editLinksPreferences"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="F9" />
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="F11" />

        <!-- F11 is already reserved for Show Desktop on OSX -->
        <key
            platform="macosx"
            commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+F11" />

        <key 
            commandId="com.treeage.treeagepro.ui.diagram.editTreePreferences"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M3+P" />
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.editTreeNumericFormatPreferences"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="F10" />
		<key 
            commandId="com.treeage.treeagepro.ui.diagram.skipGeneration"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+]" />
		<key 
            commandId="com.treeage.treeagepro.ui.diagram.unskipGeneration"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+[" />
		<key 
            commandId="com.treeage.treeagepro.ui.diagram.collapseSubtree"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+J" />
		<key 
            commandId="com.treeage.treeagepro.ui.diagram.expandSubtreeOnce"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+J" />
		<key 
            commandId="com.treeage.treeagepro.ui.diagram.expandEntireSubtree"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M3+J" />
        <!--
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.hardCollapseSubtree"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+M3+J" />
         -->
       	<key 
            commandId="com.treeage.treeagepro.ui.diagram.expectedValue"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+E" />
        <key
            commandId="com.treeage.treeagepro.ui.diagram.changeOptimalPath"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+T" />
        <key
            commandId="com.treeage.treeagepro.ui.diagram.rollBack"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+R" />
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.addBranch"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+A" />
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.selectSubtree"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+B" />    
        <key
            commandId="com.treeage.treeagepro.ui.diagram.command.subtreeBayesRevisionWizard"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+M3+B" />    
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.command.nodeComments"
            contextId="com.treeage.treeagepro.ui.editors.treeDiagramContext"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M" />
        <key 
            commandId="com.treeage.treeagepro.ui.diagram.command.evaluateAction"
            schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
            sequence="M1+M2+E" />
        <!--
        <key
              commandId="com.treeage.treeagepro.ui.filteredDefineDialog"
              contextId="org.eclipse.ui.contexts.window"
              schemeId="com.treeage.treeagepro.app.defaultAcceleratorConfiguration"
              sequence="M1+M2+V">
        </key>
        -->
    </extension>

    <extension
          point="org.eclipse.help.contexts">
          <contextProvider
                class="com.treeage.treeagepro.ui.editors.util.excel.ModelDocumentationContextProvider">
          </contextProvider>
    </extension>

   <extension
         point="org.eclipse.ui.actionSets">
      <actionSet
            label="Perspectives and Views Toolbar"
             visible="true"
             id="com.treeage.treeagepro.ui.perspectives.toolbar.actionSet">
         <action
               definitionId="com.treeage.treeagepro.ui.perspectives.viewsPullDownAction"
               class="com.treeage.treeagepro.ui.editors.diagram.actions.ShowViewsPullDownMenuAction"
               id="com.treeage.treeagepro.ui.perspectives.toolbar.ViewsPullDownAction"
               label="Views"
               style="pulldown"
               toolbarPath="treeagepro.views.toolbar.pulldown/views"               
               tooltip="Show Views">
            <enablement>
               <not>
                  <systemProperty
                        name="treeagepro.systemPropertyLockEditing"
                        value="lock">
                  </systemProperty>
               </not>
            </enablement>
         </action>
      </actionSet>

      <actionSet
            label="Navigate toolbar"
             visible="true" 
             id="com.treeage.treeagepro.ui.navigate.toolbar.actionSet" >
         <action
               definitionId="org.eclipse.ui.navigate.forward"
               class="com.treeage.treeagepro.ui.editors.diagram.actions.ForwardAction"
               id="com.treeage.treeagepro.ui.editors.diagram.actions.ForwardAction" 
               label="Forward"
               style="push"
               toolbarPath="treeagepro.navigate.toolbar.pulldown/nav"               
               tooltip="Forward"
               icon="IMG_TOOL_FORWARD"
               disabledIcon="IMG_TOOL_FORWARD_DISABLED">
          </action>
          <action
               definitionId="org.eclipse.ui.navigate.back"
               class="com.treeage.treeagepro.ui.editors.diagram.actions.BackAction"
               id="com.treeage.treeagepro.ui.editors.diagram.actions.BackAction"
               label="Back"
               style="push" 
               toolbarPath="treeagepro.navigate.toolbar.pulldown/nav"                
               tooltip="Back"
               icon="IMG_TOOL_BACK"
               disabledIcon="IMG_TOOL_BACK_DISABLED" > 
         </action>
      </actionSet>
      
      <actionSet
            label="Views Menu"
             visible="true"
             id="com.treeage.treeagepro.ui.menus.actionSet">
         <action
               class="com.treeage.treeagepro.ui.editors.diagram.actions.ShowViewsPullDownMenuAction"
               id="com.treeage.treeagepro.ui.menus.ViewsPullDownAction"
               style="pulldown"
               label="Views"
               menubarPath="window/viewsGroup">
            <enablement>
               <not>
                  <systemProperty
                        name="treeagepro.systemPropertyLockEditing"
                        value="lock">
                  </systemProperty>
               </not>
            </enablement>
         </action>
      </actionSet>
   </extension>
   
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            id="com.treeage.treeagepro.ui.playerUnlockedTester"
            type="org.eclipse.ui.part.EditorPart"
            class="com.treeage.treeagepro.ui.editors.diagram.sheets.tree.player.PlayerUnlockedTester"
            namespace="com.treeage.treeagepro.ui"
            properties="isEditorUnlocked">
      </propertyTester>
      <propertyTester
            class="com.treeage.treeagepro.ui.commands.OSPropertyTester"
            id="com.treeage.treeagepro.ui.OSPropertyTester"
            namespace="com.treeage.treeagepro.ui"
            properties="OSTEST"
            type="java.lang.Object">
      </propertyTester>
   </extension>

   <extension
         point="org.eclipse.ui.contexts">
      <context
            id="com.treeage.treeagepro.ui.treeDiagramContext"
            name="Tree Diagram Context"
            parentId="org.eclipse.ui.contexts.window">
      </context>
   </extension>
   
   <extension
         point="com.treeage.treeagepro.license.notifier">
      <notifier
            class="com.treeage.treeagepro.ui.UILicenseNotifier">
      </notifier>
   </extension>

</plugin>
